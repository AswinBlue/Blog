<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Reverse Engineering | AswinBlue</title><meta name=keywords content="C,hacking"><meta name=description content="Reverse Engineering software 를 분석하여 소스코드를 역으로 생성 해 내는 기법 software 분석 방법 Static analysis 프로그램을 실행시키지 않고 수행하는 분석이다.
프로그램의 전체 구조를 파악하기 쉬우며, 환경적 제약 사항에 자유롭고, 악성 코드의 위협으로부터 안전하다.
난독화 적용시 분석이 어려워 진다는 단점이 있다.
정적분석에 사용되는 툴로는 IDA 가 있다.
IDA 는 프리웨어로 https://hex-rays.com/ida-free/ 에서 다운 가능하다. Dynamic analysis 프로그램을 실행시키며 수행하는 분석이다. 프로그램의 개략적인 동작을 빠르게 확인 할 수 있다. 정적 분석과 반대로 프로그램 실행에 필요한 환경 구성이 어려울 수 있다."><meta name=author content="AswinBlue"><link rel=canonical href=https://aswinblue.github.io/Blog/post/systemhacking/reverse_engineering/><meta name=google-site-verification content="XYZabc"><link crossorigin=anonymous href=https://aswinblue.github.io/Blog/assets/css/stylesheet.min.f92d651568443750d127ad6450a5621c2bf278d2c45216a3d199fd40eafc2473.css integrity="sha256-+S1lFWhEN1DRJ61kUKViHCvyeNLEUhaj0Zn9QOr8JHM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=https://aswinblue.github.io/Blog/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://aswinblue.github.io/Blog/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://aswinblue.github.io/Blog accesskey=h title="AswinBlue (Alt + H)">AswinBlue</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://aswinblue.github.io/Blog/archives title=Archive><span>Archive</span></a></li><li><a href=https://aswinblue.github.io/Blog/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://aswinblue.github.io/Blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://aswinblue.github.io/Blog/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><div class=grid-container><div style=float:left;margin:30px class=auto-hide-div><ul><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webhacking/>WebHacking</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webhacking/cookie/>Cookie</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webhacking/web/>Web</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webhacking/http/>HTTP</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#1284ff><a href=https://aswinblue.github.io/Blog/post/systemhacking/>System Hacking</a><ul><li style=list-style-position:inside;text-indent:30px;color:#1284ff;content:\25ba\00a0><a href=https://aswinblue.github.io/Blog/post/systemhacking/reverse_engineering/>Reverse Engineering</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/systemhacking/exploit/>Exploit</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/systemhacking/pwntool/>Pwntool</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/assembly/>Assembly</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/assembly/assembly_basic/>Assembly_basic</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/projects/>🔷Projects</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/projects/youtube_downloader/>Youtube Downloader</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/projects/delver/>Delver</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/projects/flick_through/>FlickThrough</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/windowapp/>WindowApp</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/windowapp/window_programming/>Window_programming</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/windowapp/kivy/>Kivy</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webserver/>WebServer</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webserver/spring_boot/>Spring_boot</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webserver/spring/>Spring basic</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webserver/nodejs/>Nodejs</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/>WebApplication</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/thymeleaf/>thymeleaf</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/tailwind/>Tailwind</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/angular/>Angular</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/react_basic/>React basic</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/pythoncgi/>PythonCGI</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/javascript/>JavaScript</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/css/>Css</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/webapplication/html/>HTML</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/python/>Python</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/python/python_basic/>Python 기초</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/mobileapp/>MobileApp</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/mobileapp/flutter/>Flutter</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/machinelearning/>MachineLearning</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/machinelearning/tensorflow/>Tensorflow</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/java/>Java</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/java/jython/>Jython</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/>Linux</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/ipc/>IPC</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/thread/>Thread</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/process/>Process</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/system_programming/>System_programming</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/shell_programming/>Shell Programming</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/linux_introduction/>Linux_introduction</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/linux_env/>Linux_env</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/virtual_box/>Virtual_box</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/linux_command/>Linux commands</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/linux/linux_apt/>Linux_apt</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/hugo/>Hugo</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/hugo/hugo_dev/>Hugo 환경세팅</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/hugo/sample/>Markdown Syntax Guide</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/golang/>GoLang</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/golang/golang/>Golang</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/git/>Git</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/git/git/>Git</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/developtips/>DevelopTips</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/developtips/vscode/>VsCode</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/developtips/window/>Window</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/developtips/web_scrapping/>Web_scrapping</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/database/>DataBase</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/database/firebase_react/>Firebase_react</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/database/firebase/>Firebase</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/database/mysql/>Mysql</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/crypto/>Crypto</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/crypto/cryptocurrency/>Cryptocurrency</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/computerscience/>ComputerScience</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/computerscience/computer_science/>Computer Science</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/cloud/>Cloud</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/cloud/aws/>Aws</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/ci_cd/>CI_CD</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/ci_cd/docker/>Docker</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/algorithm/>Algorithm</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/algorithm/algorithm/>Algorithm</a></li></ul></li><li style=list-style-position:inside;text-indent:20px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/>C++</a><ul><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/unit_test/>Unit Test</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/make/>Make</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/gcc/>Gcc</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/c++_stl/>C++_stl</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/gdb/>GDB</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/c++/>C++ basic</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/cmake/>CMake</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/json_c++/>Json in C++</a></li><li style=list-style-position:inside;text-indent:30px;color:#fff><a href=https://aswinblue.github.io/Blog/post/c++/log_c++/>spdlog C++</a></li></ul></li><ul></ul><ul></ul></ul></div><main class=main style=grid-row:1;grid-column:2;width:100%><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://aswinblue.github.io/Blog>Home</a></div><h1 class=post-title>Reverse Engineering</h1><div class=post-meta><span title='2024-05-12 14:42:07 +0900 KST'>May 12, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;AswinBlue&nbsp;|&nbsp;<a href=https://github.com/AswinBlue/HugoBlog/tree/master/content/post/SystemHacking/reverse_engineering.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#reverse-engineering aria-label="Reverse Engineering">Reverse Engineering</a><ul><li><a href=#software-%eb%b6%84%ec%84%9d-%eb%b0%a9%eb%b2%95 aria-label="software 분석 방법">software 분석 방법</a><ul><li><a href=#static-analysis aria-label="Static analysis">Static analysis</a></li><li><a href=#dynamic-analysis aria-label="Dynamic analysis">Dynamic analysis</a></li></ul></li></ul></li><li><a href=#ida aria-label=IDA>IDA</a><ul><li><a href=#%eb%8b%a8%ec%b6%95%ec%96%b4 aria-label=단축어>단축어</a></li><li><a href=#%ed%99%94%eb%a9%b4 aria-label=화면>화면</a></li><li><a href=#%ed%95%a8%ec%88%98-%eb%b6%84%ec%84%9d aria-label="함수 분석">함수 분석</a><ul><li><a href=#winapi-%ea%b4%80%eb%a0%a8-%ed%95%a8%ec%88%98 aria-label="WinAPI 관련 함수">WinAPI 관련 함수</a></li></ul></li><li><a href=#%ed%95%a8%ec%88%98-%ec%88%98%ec%a0%95 aria-label="함수 수정">함수 수정</a></li></ul></li><li><a href=#ghidra aria-label=Ghidra>Ghidra</a><ul><li><a href=#%ea%b5%ac%ec%84%b1%ec%9a%94%ec%86%8c aria-label=구성요소>구성요소</a></li><li><a href=#%ec%82%ac%ec%9a%a9%eb%b2%95 aria-label=사용법>사용법</a></li></ul></li><li><a href=#ghidra-1 aria-label=Ghidra>Ghidra</a><ul><li><a href=#script aria-label=Script>Script</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=reverse-engineering>Reverse Engineering<a hidden class=anchor aria-hidden=true href=#reverse-engineering>#</a></h1><ul><li>software 를 분석하여 소스코드를 역으로 생성 해 내는 기법</li></ul><h2 id=software-분석-방법>software 분석 방법<a hidden class=anchor aria-hidden=true href=#software-분석-방법>#</a></h2><h3 id=static-analysis>Static analysis<a hidden class=anchor aria-hidden=true href=#static-analysis>#</a></h3><ul><li><p>프로그램을 실행시키지 않고 수행하는 분석이다.</p></li><li><p>프로그램의 전체 구조를 파악하기 쉬우며, 환경적 제약 사항에 자유롭고, 악성 코드의 위협으로부터 안전하다.</p></li><li><p>난독화 적용시 분석이 어려워 진다는 단점이 있다.</p></li><li><p>정적분석에 사용되는 툴로는 <code>IDA</code> 가 있다.</p><ul><li><code>IDA</code> 는 프리웨어로 <a href=https://hex-rays.com/ida-free/>https://hex-rays.com/ida-free/</a> 에서 다운 가능하다.</li></ul></li></ul><h3 id=dynamic-analysis>Dynamic analysis<a hidden class=anchor aria-hidden=true href=#dynamic-analysis>#</a></h3><ul><li>프로그램을 실행시키며 수행하는 분석이다.</li><li>프로그램의 개략적인 동작을 빠르게 확인 할 수 있다.</li><li>정적 분석과 반대로 프로그램 실행에 필요한 환경 구성이 어려울 수 있다.</li><li>안티 디버깅 기법 적용된 프로그램은 디버깅이 불가능하다.</li></ul><h1 id=ida>IDA<a hidden class=anchor aria-hidden=true href=#ida>#</a></h1><ul><li>리버스 엔지니어링 툴</li></ul><h2 id=단축어>단축어<a hidden class=anchor aria-hidden=true href=#단축어>#</a></h2><ol><li>shift + F12<ul><li>문자열 검색, String 탭으로 이동</li></ul></li><li><code>x</code><ul><li>상호참조 확인, 변수 또는 함수가 사용되는 곳의 위치를 확인</li></ul></li><li>F5<ul><li>어셈블리를 C 언어 형태로 변환</li></ul></li><li><code>g</code><ul><li>특정 주소 혹은 라인으로 이동</li><li>디컴파일 된 함수 이름 위에 커서를 놓고 g 를 누르면 어셈블리 상 함수 라인을 확인할 수 있다.</li><li>함수 이름을 적어도 함수 위치로 이동된다.</li></ul></li><li>ESC<ul><li>이전 커서 위치로 이동</li></ul></li><li>Ctrl + Enter<ul><li>다음 커서 위치로 이동</li></ul></li><li><code>n</code><ul><li>변수 이름 바꾸기</li></ul></li><li><code>Y</code><ul><li>변수 타입 설정</li><li>함수 매개변수 변경, 함수 매개변수 타입 변경</li></ul></li><li>F2<ul><li>어셈블리 혹은 C 언어 라인에서는 break point(중단점) 설정</li><li>stack 또는 hex View 에서는 값 변경</li></ul></li><li>F9</li></ol><ul><li>실행 (run)</li><li>프로그램을 실행시켜 동적 분석을 수행할 수 있다.</li></ul><ol start=11><li>F8</li></ol><ul><li>한 단계 실행 (next)</li></ul><ol start=12><li>F7</li></ol><ul><li>함수 내부로 진입 (step int)</li></ul><ol start=13><li>Ctrl + F2</li></ol><ul><li>디버깅 중단</li></ul><ol start=14><li><code>r</code></li></ol><ul><li>hex 데이터를 문자로 변환</li></ul><ol start=15><li>Shift + E</li></ol><ul><li>선택한 값을 원하는 형태로 변환하여 추출(export)</li><li>hex 데이터를 문자열로 추출할 때 유용하다.</li></ul><h2 id=화면>화면<a hidden class=anchor aria-hidden=true href=#화면>#</a></h2><ol><li><p>IDA View</p><ul><li>어셈블리 코드, 디컴파일 결과, Hex-View, 구조체 목록 등 필요에 따른 화면 표시</li></ul></li><li><p>Stack of main</p><ul><li>main 함수의 stack</li></ul></li><li><p>String</p><ul><li>코드 내 검색되는 모든 문자열 표시 화면</li><li>문자열 더블클릭 시 assembly code view로 이동</li></ul></li><li><p>Functions</p><ul><li>코드 내 인식되는 함수들 표기</li><li>Ctrl + F 로 검색 가능</li></ul></li><li><p>Graph overview</p><ul><li><code>IDA View</code> 가 그래프로 표시된 경우, 전체 그래프 중 <code>IDA View</code> 에 표시된 화면 표기</li></ul></li></ol><h2 id=함수-분석>함수 분석<a hidden class=anchor aria-hidden=true href=#함수-분석>#</a></h2><ul><li><code>_stdio_common_vfprintf()</code> : printf 함수 출력시 호출되는 함수이다.</li><li><code>_stdio_common_vfscanf()</code> : scanf 함수 출력시 호출되는 함수이다.</li><li><code>__ROL1__(TARGET, NUM)</code> : TARGET (숫자)을 좌측으로 NUM 번 shift 시키고, 8bit 비트 위로 밀려난 좌측 인자들을 오른쪽 빈자리에 다시 집어넣는 함수<ul><li>reversing code<pre tabindex=0><code>def rol1(v, s):
    v = (v &lt;&lt; s) | (v &gt;&gt; (8 - s))  # bit shift &amp; push back
    return v &amp; 0xff  # 8bit 영역만 사용
</code></pre></li></ul></li><li><code>__popcnt(NUM)</code> : NUM 을 2진수로 변경했을 때 1의 갯수를 반환<ul><li>reversing code<pre tabindex=0><code>def popcnt(v):
    return bin(v).count(&#39;1&#39;)
</code></pre></li></ul></li><li><code>__ROR1__(TARGET, NUM)</code> : TARGET (숫자)을 우측으로 NUM 번 shift 시키고, 8bit 비트 위로 밀려난 우측 인자들을 왼쪽 빈자리에 다시 집어넣는 함수<ul><li>reversing code<pre tabindex=0><code>def ror(value, count) :
    tmp1 = value &gt;&gt; count
    tmp2 = value &lt;&lt; (8 - count)
    return((tmp1 + tmp2) % 2**8)
</code></pre></li></ul></li><li><code>MEMORY[]</code> : 메모리 주소에 담긴 값을 나타냄<ul><li><code>MEMORY[0xDEADBEEF000]</code> 은 0xDEADBEEF000 번지 주소의 값을 반환함</li></ul></li></ul><h3 id=winapi-관련-함수>WinAPI 관련 함수<a hidden class=anchor aria-hidden=true href=#winapi-관련-함수>#</a></h3><ul><li>API 관련 문서는 <a href=https://learn.microsoft.com/en-us/windows/win32/api/>MSDN 링크</a> 에서 찾아볼 수 있다.</li><li><code>__stdcall WinMain</code> : GUI 실행시 가장 먼저 호출되는 함수</li><li><code>RegisterClassExW(v11)</code> : 윈도우 클래스 등록하는 함수<ul><li>인자로 들어가는 &ldquo;v11&rdquo; 변수는 윈도우 클래스이다.</li><li><code>lpfnWndProc</code> : 윈도우의 메시지 콜백 함수로, 개발자가 의도한 윈도우의 business logic은 주로 이 함수 안에서 정의되어 있다.</li></ul></li></ul><h2 id=함수-수정>함수 수정<a hidden class=anchor aria-hidden=true href=#함수-수정>#</a></h2><ul><li>assembly 코드 화면에서 메뉴 -> edit -> patch program -> assemble 메뉴를 클릭하면 해당 라인의 어셈블리를 변경할 수 있다.</li><li>변경 이후에는 다시 메뉴 -> edit -> -> patch program -> apply patch to input file 을 선택하면 패치가 적용된다.</li></ul><hr><h1 id=ghidra>Ghidra<a hidden class=anchor aria-hidden=true href=#ghidra>#</a></h1><ul><li>NASA에서 사용하는 리버스 엔지니어링 툴로, 오픈소스로 공개되어 있다.</li><li>jdk를 사용하고 <a href="https://github.com/NationalSecurityAgency/ghidra/releases?page=2">github</a> 에서 다운로드 가능하다.</li><li>다양한 도구들을 내장하고 있으며, GUI도 지원이 가능하다.</li></ul><h2 id=구성요소>구성요소<a hidden class=anchor aria-hidden=true href=#구성요소>#</a></h2><ol><li><p>Code Browser</p><ul><li>Ghidra 에 내장된 도구로, 다음 기능이 가능하다.<ul><li>디스어셈블: 분석 대상 프로그램의 기계어를 역으로 어셈블하여 어셈블리 언어 형태의 코드로 보여줍니다.</li><li>디컴파일: 디스어셈블 결과를 C언어 형태로 디컴파일하여 사람이 이해하기 쉬운 코드로 변환하여 보여줍니다.</li><li>코드 자동 분석: 프로그램 내에 존재하는 함수들을 자동으로 식별하고, 변수의 타입을 추론합니다.</li><li>코드 시각화: 제어 흐름 그래프(Control Flow Graph)로 코드의 흐름을 시각적으로 표현하여 코드의 복잡한 구조를 비교적 쉽게 파악할 수 있습니다.</li><li>스크립팅: 사용자가 자신의 요구에 맞게 분석 프로세스를 스크립트로 작성하고 실행할 수 있습니다.</li><li>심볼 정보 수정</li><li>주석 기능</li><li>프로그램 흐름 시각화(Graph View)</li></ul></li><li><a href=https://ghidra-sre.org/CheatSheet.html>단축키 참조</a></li></ul><ol><li>디컴파일 창(Decompile)<ul><li>C언어 형태로 디컴파일된 코드를 볼 수 있습니다. 디스어셈블 리스팅(2번 윈도우)에서 어셈블리 명령어를 클릭하면 해당 부분을 디컴파일하여 디컴파일 윈도우에서 보여줍니다.</li><li>함수를 자동으로 추정하여 아래 정보를 추출 해 냄 (추정한 정보이기 때문에 부정확할 수 있음, pointer 타입이 long 타입으로 지정될 수 있다)<ul><li>함수 호출 규약</li><li>반환 타입</li><li>함수 이름</li><li>파라미터 타입과 이름</li></ul></li><li>함수 이름에 마우스 우클릭 -> <code>Edit Function Signature</code> 을 선택하여 함수 정보를 수정할 수 있음</li><li>변수에 우클릭 -> <code>Rename Variable</code> 선택하여 변수 이름 수정 가능</li><li>변수에 오클릭 -> <code>Retype Variable</code> 선택하여 변수 타입 수정 가능</li><li>공간에 우클릭 -> Comments -> <code>Set Pre Comment</code> 로 주석 작성 가능</li><li>공간에 우클릭 -> <code>Bookmark</code>로 북마크 설정 가능<ul><li>메뉴 -> Windows -> Bookmark 로 새로운 창 띄워서 설정한 bookmark list 확인 가능</li></ul></li></ul></li><li>디스어셈블 리스팅(Listing)<ul><li>디스어셈블된 코드를 볼 수 있습니다. 디컴파일 창(1번 윈도우)에서 원하는 부분을 클릭하면 해당 부분을 디스어셈블 리스팅에서 보여줍니다.</li></ul></li><li>심볼 트리(Symbol Tree)<ul><li>프로그램에 존재하는 심볼들(함수 이름)을 볼 수 있습니다. 원하는 심볼을 더블클릭하면 디스어셈블 리스팅이 해당 위치로 이동합니다.</li></ul></li><li>프로그램 트리(Program Trees)<ul><li>프로그램을 계층 구조로 쪼개어 보여줍니다. 예를 들어서 리눅스 실행 파일 포맷인 ELF 프로그램의 경우, 내부적으로 .text, .data, .rodata와 같은 섹션으로 나누어져 있습니다. 프로그램 트리에서 특정 섹션을 클릭하면, 디스어셈블 리스팅이 해당하는 섹션의 위치로 이동합니다.</li></ul></li><li>데이터 타입 매니저(Data Type Manager)<ul><li>데이터 타입을 관리할 수 있는 창입니다. 라이브러리에 정의된 타입을 불러오거나 분석을 통해 알아낸 구조체를 관리할 수 있습니다.</li><li>복잡한 프로그램을 분석하는 과정에서 구조체를 수동으로 식별하여 관리하는 작업에 사용</li><li>구조체 추가<ul><li>프로그램 이름이 적힌 폴더에 우클릭 -> New -> Structure 선택</li></ul></li></ul></li><li>콘솔(Console)<ul><li>Ghidra 스크립트의 실행 결과가 출력.</li><li>스크립팅 기능으로 자동화 가능</li></ul></li><li>Byte viewer</li></ol><ul><li>메뉴 -> Window -> bytes:~~~ 선택하여 바이너리를 byte 로 읽은 내용 확인</li></ul><ol start=8><li>함수 호출관계 그래프</li></ol><ul><li>메뉴 -> Window -> <code>Function Call Graph</code> 선택하여 함수간 링킹 관계 표시 (정적 링킹은 동적링킹에 비해 복잡하게 표시될 수 있음)</li></ul><ol start=9><li>함수 그래프</li></ol><ul><li>메뉴 -> Window -> <code>Function Graph</code> 로 어셈블리 코드상 함수 호출 구조를 확인</li></ul></li></ol><h2 id=사용법>사용법<a hidden class=anchor aria-hidden=true href=#사용법>#</a></h2><ol><li>문자열 검색 : 메뉴 -> search -> For String</li><li>주소 역참조 : disassem 화면에서 주소에 마우스 우클릭 -> references -> show reference to address</li></ol><h1 id=ghidra-1>Ghidra<a hidden class=anchor aria-hidden=true href=#ghidra-1>#</a></h1><ul><li>오픈소스 리버싱 툴</li></ul><h2 id=script>Script<a hidden class=anchor aria-hidden=true href=#script>#</a></h2><ul><li>스크립트를 활용하여 반복적인 작업을 자동화 할 수 있다.</li><li><code>Script Manager</code> 를 활용하여</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://aswinblue.github.io/Blog/tags/c/>c</a></li><li><a href=https://aswinblue.github.io/Blog/tags/hacking/>hacking</a></li></ul><nav class=paginav><a class=prev href=https://aswinblue.github.io/Blog/post/windowapp/window_programming/><span class=title>« Prev</span><br><span>Window_programming</span></a>
<a class=next href=https://aswinblue.github.io/Blog/post/systemhacking/exploit/><span class=title>Next »</span><br><span>Exploit</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Reverse Engineering on twitter" href="https://twitter.com/intent/tweet/?text=Reverse%20Engineering&amp;url=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fsystemhacking%2freverse_engineering%2f&amp;hashtags=C%2chacking"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reverse Engineering on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fsystemhacking%2freverse_engineering%2f&amp;title=Reverse%20Engineering&amp;summary=Reverse%20Engineering&amp;source=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fsystemhacking%2freverse_engineering%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reverse Engineering on reddit" href="https://reddit.com/submit?url=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fsystemhacking%2freverse_engineering%2f&title=Reverse%20Engineering"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reverse Engineering on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fsystemhacking%2freverse_engineering%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reverse Engineering on whatsapp" href="https://api.whatsapp.com/send?text=Reverse%20Engineering%20-%20https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fsystemhacking%2freverse_engineering%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Reverse Engineering on telegram" href="https://telegram.me/share/url?text=Reverse%20Engineering&amp;url=https%3a%2f%2faswinblue.github.io%2fBlog%2fpost%2fsystemhacking%2freverse_engineering%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><div class=auto-hide-div><ins class=kakao_ad_area style=display:none;position:fixed data-ad-unit=DAN-17Lk24lxFVgxtePU data-ad-width=160 data-ad-height=auto></ins></div><script type=text/javascript src=//t1.daumcdn.net/kas/static/ba.min.js async></script></div><footer class=footer><span>&copy; 2025 <a href=https://aswinblue.github.io/Blog>AswinBlue</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>